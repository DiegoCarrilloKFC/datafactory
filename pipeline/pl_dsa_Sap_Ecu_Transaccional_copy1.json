{
	"name": "pl_dsa_Sap_Ecu_Transaccional_copy1",
	"properties": {
		"activities": [
			{
				"name": "OrdenManofactura",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "produccionplanta/ORDENMANOFACTURA",
							"wildcardFileName": {
								"value": "@Concat('ORDENMANOFACTURA_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "TRUNCATE TABLE [dsa_ecu_sap].[ORDENMANOFACTURA]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "produccionplanta/ORDENMANOFACTURA"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sap_OrdenManofactura",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "DeleteOrdenManofactura",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "OrdenManofactura",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "produccionplanta/ORDENMANOFACTURA"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/produccionplanta/ORDENMANOFACTURA"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "DeleteEntradaDiario",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "EntradaDiario",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "contabilidadcar/ENTRADADIARIO"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/contabilidadcar/ENTRADADIARIO"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "EntradaDiario",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "contabilidadcar/ENTRADADIARIO",
							"wildcardFileName": {
								"value": "@Concat('ENTRADADIARIO_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "TRUNCATE TABLE [dsa_ecu_sap].[entradadiario]",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "FECHACARGA",
									"type": "String"
								},
								"sink": {
									"name": "FECHACARGA"
								}
							},
							{
								"source": {
									"name": "MANDT",
									"type": "String"
								},
								"sink": {
									"name": "MANDT"
								}
							},
							{
								"source": {
									"name": "GLACCOUNT",
									"type": "String"
								},
								"sink": {
									"name": "GLACCOUNT"
								}
							},
							{
								"source": {
									"name": "POSTINGDATE",
									"type": "String"
								},
								"sink": {
									"name": "POSTINGDATE"
								}
							},
							{
								"source": {
									"name": "AMOUNTINCOMPANYCODECURRENCY",
									"type": "Decimal"
								},
								"sink": {
									"name": "AMOUNTINCOMPANYCODECURRENCY"
								}
							},
							{
								"source": {
									"name": "ACCOUNTINGDOCUMENT",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTINGDOCUMENT"
								}
							},
							{
								"source": {
									"name": "DOCUMENTITEMTEXT",
									"type": "String"
								},
								"sink": {
									"name": "DOCUMENTITEMTEXT"
								}
							},
							{
								"source": {
									"name": "ACCOUNTINGDOCUMENTCATEGORY",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTINGDOCUMENTCATEGORY"
								}
							},
							{
								"source": {
									"name": "LEDGER",
									"type": "String"
								},
								"sink": {
									"name": "LEDGER"
								}
							},
							{
								"source": {
									"name": "COMPANYCODE",
									"type": "String"
								},
								"sink": {
									"name": "COMPANYCODE"
								}
							},
							{
								"source": {
									"name": "FISCALPERIOD",
									"type": "Int32"
								},
								"sink": {
									"name": "FISCALPERIOD"
								}
							},
							{
								"source": {
									"name": "FISCALYEAR",
									"type": "Int32"
								},
								"sink": {
									"name": "FISCALYEAR"
								}
							},
							{
								"source": {
									"name": "COSTCENTER",
									"type": "String"
								},
								"sink": {
									"name": "COSTCENTER"
								}
							},
							{
								"source": {
									"name": "PROFITCENTER",
									"type": "String"
								},
								"sink": {
									"name": "PROFITCENTER"
								}
							},
							{
								"source": {
									"name": "SEGMENT",
									"type": "String"
								},
								"sink": {
									"name": "SEGMENT"
								}
							},
							{
								"source": {
									"name": "COMPANYCODECURRENCY",
									"type": "String"
								},
								"sink": {
									"name": "COMPANYCODECURRENCY"
								}
							},
							{
								"source": {
									"name": "GLOBALCURRENCY",
									"type": "String"
								},
								"sink": {
									"name": "GLOBALCURRENCY"
								}
							},
							{
								"source": {
									"name": "AMOUNTINGLOBALCURRENCY",
									"type": "Decimal"
								},
								"sink": {
									"name": "AMOUNTINGLOBALCURRENCY"
								}
							},
							{
								"source": {
									"name": "QUANTITY",
									"type": "Decimal"
								},
								"sink": {
									"name": "QUANTITY"
								}
							},
							{
								"source": {
									"name": "BASEUNIT",
									"type": "String"
								},
								"sink": {
									"name": "BASEUNIT"
								}
							},
							{
								"source": {
									"name": "COSTSOURCEUNIT",
									"type": "String"
								},
								"sink": {
									"name": "COSTSOURCEUNIT"
								}
							},
							{
								"source": {
									"name": "DEBITCREDITCODE",
									"type": "String"
								},
								"sink": {
									"name": "DEBITCREDITCODE"
								}
							},
							{
								"source": {
									"name": "DOCUMENTDATE",
									"type": "String"
								},
								"sink": {
									"name": "DOCUMENTDATE"
								}
							},
							{
								"source": {
									"name": "POSTINGKEY",
									"type": "String"
								},
								"sink": {
									"name": "POSTINGKEY"
								}
							},
							{
								"source": {
									"name": "ACCOUNTINGDOCUMENTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTINGDOCUMENTTYPE"
								}
							},
							{
								"source": {
									"name": "MATERIAL",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL"
								}
							},
							{
								"source": {
									"name": "PLANT",
									"type": "String"
								},
								"sink": {
									"name": "PLANT"
								}
							},
							{
								"source": {
									"name": "SUPPLIER",
									"type": "String"
								},
								"sink": {
									"name": "SUPPLIER"
								}
							},
							{
								"source": {
									"name": "CUSTOMER",
									"type": "String"
								},
								"sink": {
									"name": "CUSTOMER"
								}
							},
							{
								"source": {
									"name": "FINANCIALACCOUNTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "FINANCIALACCOUNTTYPE"
								}
							},
							{
								"source": {
									"name": "LASTCHANGEDATETIME",
									"type": "String"
								},
								"sink": {
									"name": "LASTCHANGEDATETIME"
								}
							},
							{
								"source": {
									"name": "LEDGERGLLINEITEM",
									"type": "String"
								},
								"sink": {
									"name": "LEDGERGLLINEITEM"
								}
							},
							{
								"source": {
									"name": "LEDGERFISCALYEAR",
									"type": "String"
								},
								"sink": {
									"name": "LEDGERFISCALYEAR"
								}
							},
							{
								"source": {
									"name": "FINANCIALTRANSACTIONTYPE",
									"type": "String"
								},
								"sink": {
									"name": "FINANCIALTRANSACTIONTYPE"
								}
							},
							{
								"source": {
									"name": "REFERENCEDOCUMENT",
									"type": "String"
								},
								"sink": {
									"name": "REFERENCEDOCUMENT"
								}
							},
							{
								"source": {
									"name": "REFERENCEDOCUMENTITEM",
									"type": "String"
								},
								"sink": {
									"name": "REFERENCEDOCUMENTITEM"
								}
							},
							{
								"source": {
									"name": "ISREVERSAL",
									"type": "String"
								},
								"sink": {
									"name": "ISREVERSAL"
								}
							},
							{
								"source": {
									"name": "ISREVERSED",
									"type": "String"
								},
								"sink": {
									"name": "ISREVERSED"
								}
							},
							{
								"source": {
									"name": "REVERSALREFERENCEDOCUMENT",
									"type": "String"
								},
								"sink": {
									"name": "REVERSALREFERENCEDOCUMENT"
								}
							},
							{
								"source": {
									"name": "ISSETTLEMENT",
									"type": "String"
								},
								"sink": {
									"name": "ISSETTLEMENT"
								}
							},
							{
								"source": {
									"name": "ISSETTLED",
									"type": "String"
								},
								"sink": {
									"name": "ISSETTLED"
								}
							},
							{
								"source": {
									"name": "SOURCEREFERENCEDOCUMENTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "SOURCEREFERENCEDOCUMENTTYPE"
								}
							},
							{
								"source": {
									"name": "PARTNERCOSTCENTER",
									"type": "String"
								},
								"sink": {
									"name": "PARTNERCOSTCENTER"
								}
							},
							{
								"source": {
									"name": "PARTNERPROFITCENTER",
									"type": "String"
								},
								"sink": {
									"name": "PARTNERPROFITCENTER"
								}
							},
							{
								"source": {
									"name": "BALANCETRANSACTIONCURRENCY",
									"type": "String"
								},
								"sink": {
									"name": "BALANCETRANSACTIONCURRENCY"
								}
							},
							{
								"source": {
									"name": "AMOUNTINBALANCETRANSACCRCY",
									"type": "Decimal"
								},
								"sink": {
									"name": "AMOUNTINBALANCETRANSACCRCY"
								}
							},
							{
								"source": {
									"name": "TRANSACTIONCURRENCY",
									"type": "String"
								},
								"sink": {
									"name": "TRANSACTIONCURRENCY"
								}
							},
							{
								"source": {
									"name": "AMOUNTINTRANSACTIONCURRENCY",
									"type": "Decimal"
								},
								"sink": {
									"name": "AMOUNTINTRANSACTIONCURRENCY"
								}
							},
							{
								"source": {
									"name": "FIXEDQUANTITY",
									"type": "Decimal"
								},
								"sink": {
									"name": "FIXEDQUANTITY"
								}
							},
							{
								"source": {
									"name": "VALUATIONQUANTITY",
									"type": "Decimal"
								},
								"sink": {
									"name": "VALUATIONQUANTITY"
								}
							},
							{
								"source": {
									"name": "VALUATIONFIXEDQUANTITY",
									"type": "Decimal"
								},
								"sink": {
									"name": "VALUATIONFIXEDQUANTITY"
								}
							},
							{
								"source": {
									"name": "FISCALYEARVARIANT",
									"type": "String"
								},
								"sink": {
									"name": "FISCALYEARVARIANT"
								}
							},
							{
								"source": {
									"name": "FISCALYEARPERIOD",
									"type": "String"
								},
								"sink": {
									"name": "FISCALYEARPERIOD"
								}
							},
							{
								"source": {
									"name": "ACCOUNTINGDOCUMENTITEM",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTINGDOCUMENTITEM"
								}
							},
							{
								"source": {
									"name": "ACCOUNTINGDOCCREATEDBYUSER",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTINGDOCCREATEDBYUSER"
								}
							},
							{
								"source": {
									"name": "CREATIONDATETIME",
									"type": "String"
								},
								"sink": {
									"name": "CREATIONDATETIME"
								}
							},
							{
								"source": {
									"name": "CREATIONDATE",
									"type": "String"
								},
								"sink": {
									"name": "CREATIONDATE"
								}
							},
							{
								"source": {
									"name": "GLACCOUNTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "GLACCOUNTTYPE"
								}
							},
							{
								"source": {
									"name": "INVOICEREFERENCE",
									"type": "String"
								},
								"sink": {
									"name": "INVOICEREFERENCE"
								}
							},
							{
								"source": {
									"name": "INVOICEITEMREFERENCE",
									"type": "String"
								},
								"sink": {
									"name": "INVOICEITEMREFERENCE"
								}
							},
							{
								"source": {
									"name": "PURCHASINGDOCUMENT",
									"type": "String"
								},
								"sink": {
									"name": "PURCHASINGDOCUMENT"
								}
							},
							{
								"source": {
									"name": "PURCHASINGDOCUMENTITEM",
									"type": "String"
								},
								"sink": {
									"name": "PURCHASINGDOCUMENTITEM"
								}
							},
							{
								"source": {
									"name": "ACCOUNTASSIGNMENTNUMBER",
									"type": "String"
								},
								"sink": {
									"name": "ACCOUNTASSIGNMENTNUMBER"
								}
							},
							{
								"source": {
									"name": "SALESORDER",
									"type": "String"
								},
								"sink": {
									"name": "SALESORDER"
								}
							},
							{
								"source": {
									"name": "SALESORDERITEM",
									"type": "String"
								},
								"sink": {
									"name": "SALESORDERITEM"
								}
							},
							{
								"source": {
									"name": "SALESDOCUMENT",
									"type": "String"
								},
								"sink": {
									"name": "SALESDOCUMENT"
								}
							},
							{
								"source": {
									"name": "SALESDOCUMENTITEM",
									"type": "String"
								},
								"sink": {
									"name": "SALESDOCUMENTITEM"
								}
							},
							{
								"source": {
									"name": "PRODUCT",
									"type": "String"
								},
								"sink": {
									"name": "PRODUCT"
								}
							},
							{
								"source": {
									"name": "TAXCODE",
									"type": "String"
								},
								"sink": {
									"name": "TAXCODE"
								}
							},
							{
								"source": {
									"name": "HOUSEBANK",
									"type": "String"
								},
								"sink": {
									"name": "HOUSEBANK"
								}
							},
							{
								"source": {
									"name": "HOUSEBANKACCOUNT",
									"type": "String"
								},
								"sink": {
									"name": "HOUSEBANKACCOUNT"
								}
							},
							{
								"source": {
									"name": "COSTESTIMATE",
									"type": "String"
								},
								"sink": {
									"name": "COSTESTIMATE"
								}
							},
							{
								"source": {
									"name": "OFFSETTINGACCOUNT",
									"type": "String"
								},
								"sink": {
									"name": "OFFSETTINGACCOUNT"
								}
							},
							{
								"source": {
									"name": "OFFSETTINGACCOUNTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "OFFSETTINGACCOUNTTYPE"
								}
							},
							{
								"source": {
									"name": "PARTNERCOMPANYCODE",
									"type": "String"
								},
								"sink": {
									"name": "PARTNERCOMPANYCODE"
								}
							},
							{
								"source": {
									"name": "ORIGINCOSTCENTER",
									"type": "String"
								},
								"sink": {
									"name": "ORIGINCOSTCENTER"
								}
							},
							{
								"source": {
									"name": "ORIGINPROFITCENTER",
									"type": "String"
								},
								"sink": {
									"name": "ORIGINPROFITCENTER"
								}
							},
							{
								"source": {
									"name": "ORDERID",
									"type": "String"
								},
								"sink": {
									"name": "ORDERID"
								}
							},
							{
								"source": {
									"name": "ORDERCATEGORY",
									"type": "String"
								},
								"sink": {
									"name": "ORDERCATEGORY"
								}
							},
							{
								"source": {
									"name": "PARTNERORDER",
									"type": "String"
								},
								"sink": {
									"name": "PARTNERORDER"
								}
							},
							{
								"source": {
									"name": "PARTNERORDERCATEGORY",
									"type": "String"
								},
								"sink": {
									"name": "PARTNERORDERCATEGORY"
								}
							},
							{
								"source": {
									"name": "BILLINGDOCUMENTTYPE",
									"type": "String"
								},
								"sink": {
									"name": "BILLINGDOCUMENTTYPE"
								}
							},
							{
								"source": {
									"name": "SOLDMATERIAL",
									"type": "String"
								},
								"sink": {
									"name": "SOLDMATERIAL"
								}
							},
							{
								"source": {
									"name": "SOLDPRODUCT",
									"type": "String"
								},
								"sink": {
									"name": "SOLDPRODUCT"
								}
							},
							{
								"source": {
									"name": "MATERIALGROUP",
									"type": "String"
								},
								"sink": {
									"name": "MATERIALGROUP"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "contabilidadcar/ENTRADADIARIO"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sap_entradadiario",
						"type": "DatasetReference"
					}
				]
			}
		],
		"parameters": {
			"Anio": {
				"type": "string",
				"defaultValue": "2020"
			},
			"Mes": {
				"type": "string",
				"defaultValue": "12"
			},
			"Dia": {
				"type": "string",
				"defaultValue": "08"
			}
		},
		"folder": {
			"name": "dsa_Sap"
		},
		"annotations": []
	}
}