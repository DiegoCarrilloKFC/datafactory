{
	"name": "pl_dsa_Sap_Ecu_Transaccional_Reproceso",
	"properties": {
		"activities": [
			{
				"name": "EntradaDiario",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"maxConcurrentConnections": 1,
							"recursive": true,
							"wildcardFolderPath": "reproceso/contabilidad",
							"wildcardFileName": {
								"value": "@Concat('ENTRADADIARIO_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "TRUNCATE TABLE [dsa_ecu_sap].[entradadiario_prueba]",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"sink": {
									"name": "MANDT"
								}
							},
							{
								"sink": {
									"name": "GLACCOUNT"
								}
							},
							{
								"sink": {
									"name": "POSTINGDATE"
								}
							},
							{
								"sink": {
									"name": "AMOUNTINCOMPANYCODECURRENCY"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTINGDOCUMENT"
								}
							},
							{
								"sink": {
									"name": "DOCUMENTITEMTEXT"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTINGDOCUMENTCATEGORY"
								}
							},
							{
								"sink": {
									"name": "LEDGER"
								}
							},
							{
								"sink": {
									"name": "COMPANYCODE"
								}
							},
							{
								"sink": {
									"name": "FISCALPERIOD"
								}
							},
							{
								"sink": {
									"name": "FISCALYEAR"
								}
							},
							{
								"sink": {
									"name": "COSTCENTER"
								}
							},
							{
								"sink": {
									"name": "PROFITCENTER"
								}
							},
							{
								"sink": {
									"name": "SEGMENT"
								}
							},
							{
								"sink": {
									"name": "COMPANYCODECURRENCY"
								}
							},
							{
								"sink": {
									"name": "GLOBALCURRENCY"
								}
							},
							{
								"sink": {
									"name": "AMOUNTINGLOBALCURRENCY"
								}
							},
							{
								"sink": {
									"name": "QUANTITY"
								}
							},
							{
								"sink": {
									"name": "BASEUNIT"
								}
							},
							{
								"sink": {
									"name": "COSTSOURCEUNIT"
								}
							},
							{
								"sink": {
									"name": "DEBITCREDITCODE"
								}
							},
							{
								"sink": {
									"name": "DOCUMENTDATE"
								}
							},
							{
								"sink": {
									"name": "POSTINGKEY"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTINGDOCUMENTTYPE"
								}
							},
							{
								"sink": {
									"name": "MATERIAL"
								}
							},
							{
								"sink": {
									"name": "PLANT"
								}
							},
							{
								"sink": {
									"name": "SUPPLIER"
								}
							},
							{
								"sink": {
									"name": "CUSTOMER"
								}
							},
							{
								"sink": {
									"name": "FINANCIALACCOUNTTYPE"
								}
							},
							{
								"sink": {
									"name": "LASTCHANGEDATETIME"
								}
							},
							{
								"sink": {
									"name": "FECHACARGA"
								}
							},
							{
								"sink": {
									"name": "LEDGERGLLINEITEM"
								}
							},
							{
								"sink": {
									"name": "LEDGERFISCALYEAR"
								}
							},
							{
								"sink": {
									"name": "FINANCIALTRANSACTIONTYPE"
								}
							},
							{
								"sink": {
									"name": "REFERENCEDOCUMENT"
								}
							},
							{
								"sink": {
									"name": "REFERENCEDOCUMENTITEM"
								}
							},
							{
								"sink": {
									"name": "ISREVERSAL"
								}
							},
							{
								"sink": {
									"name": "ISREVERSED"
								}
							},
							{
								"sink": {
									"name": "REVERSALREFERENCEDOCUMENT"
								}
							},
							{
								"sink": {
									"name": "ISSETTLEMENT"
								}
							},
							{
								"sink": {
									"name": "ISSETTLED"
								}
							},
							{
								"sink": {
									"name": "SOURCEREFERENCEDOCUMENTTYPE"
								}
							},
							{
								"sink": {
									"name": "PARTNERCOSTCENTER"
								}
							},
							{
								"sink": {
									"name": "PARTNERPROFITCENTER"
								}
							},
							{
								"sink": {
									"name": "BALANCETRANSACTIONCURRENCY"
								}
							},
							{
								"sink": {
									"name": "AMOUNTINBALANCETRANSACCRCY"
								}
							},
							{
								"sink": {
									"name": "TRANSACTIONCURRENCY"
								}
							},
							{
								"sink": {
									"name": "AMOUNTINTRANSACTIONCURRENCY"
								}
							},
							{
								"sink": {
									"name": "FIXEDQUANTITY"
								}
							},
							{
								"sink": {
									"name": "VALUATIONQUANTITY"
								}
							},
							{
								"sink": {
									"name": "VALUATIONFIXEDQUANTITY"
								}
							},
							{
								"sink": {
									"name": "FISCALYEARVARIANT"
								}
							},
							{
								"sink": {
									"name": "FISCALYEARPERIOD"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTINGDOCUMENTITEM"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTINGDOCCREATEDBYUSER"
								}
							},
							{
								"sink": {
									"name": "CREATIONDATETIME"
								}
							},
							{
								"sink": {
									"name": "CREATIONDATE"
								}
							},
							{
								"sink": {
									"name": "GLACCOUNTTYPE"
								}
							},
							{
								"sink": {
									"name": "INVOICEREFERENCE"
								}
							},
							{
								"sink": {
									"name": "INVOICEITEMREFERENCE"
								}
							},
							{
								"sink": {
									"name": "PURCHASINGDOCUMENT"
								}
							},
							{
								"sink": {
									"name": "PURCHASINGDOCUMENTITEM"
								}
							},
							{
								"sink": {
									"name": "ACCOUNTASSIGNMENTNUMBER"
								}
							},
							{
								"sink": {
									"name": "SALESORDER"
								}
							},
							{
								"sink": {
									"name": "SALESORDERITEM"
								}
							},
							{
								"sink": {
									"name": "SALESDOCUMENT"
								}
							},
							{
								"sink": {
									"name": "SALESDOCUMENTITEM"
								}
							},
							{
								"sink": {
									"name": "PRODUCT"
								}
							},
							{
								"sink": {
									"name": "TAXCODE"
								}
							},
							{
								"sink": {
									"name": "HOUSEBANK"
								}
							},
							{
								"sink": {
									"name": "HOUSEBANKACCOUNT"
								}
							},
							{
								"sink": {
									"name": "COSTESTIMATE"
								}
							},
							{
								"sink": {
									"name": "OFFSETTINGACCOUNT"
								}
							},
							{
								"sink": {
									"name": "OFFSETTINGACCOUNTTYPE"
								}
							},
							{
								"sink": {
									"name": "PARTNERCOMPANYCODE"
								}
							},
							{
								"sink": {
									"name": "ORIGINCOSTCENTER"
								}
							},
							{
								"sink": {
									"name": "ORIGINPROFITCENTER"
								}
							},
							{
								"sink": {
									"name": "ORDERID"
								}
							},
							{
								"sink": {
									"name": "ORDERCATEGORY"
								}
							},
							{
								"sink": {
									"name": "PARTNERORDER"
								}
							},
							{
								"sink": {
									"name": "PARTNERORDERCATEGORY"
								}
							},
							{
								"sink": {
									"name": "BILLINGDOCUMENTTYPE"
								}
							},
							{
								"sink": {
									"name": "SOLDMATERIAL"
								}
							},
							{
								"sink": {
									"name": "SOLDPRODUCT"
								}
							},
							{
								"sink": {
									"name": "MATERIALGROUP"
								}
							},
							{
								"sink": {
									"name": "DIVISION"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "reproceso/contabilidad"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_sap_entradadiario_prueba",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Copy Blob Entrada Diario",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "EntradaDiario",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"modifiedDatetimeStart": {
								"value": "@addHours(pipeline().TriggerTime,-6)",
								"type": "Expression"
							},
							"modifiedDatetimeEnd": {
								"value": "@addHours(pipeline().TriggerTime,-4)",
								"type": "Expression"
							},
							"wildcardFolderPath": "reproceso/contabilidad",
							"wildcardFileName": {
								"value": "@Concat('ENTRADADIARIO_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							},
							"enablePartitionDiscovery": false
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings",
							"copyBehavior": "MergeFiles"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "reproceso/contabilidad"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "reproceso/contabilidadLeidos"
						}
					}
				]
			}
		],
		"parameters": {
			"Anio": {
				"type": "string",
				"defaultValue": "2020"
			},
			"Mes": {
				"type": "string",
				"defaultValue": "12"
			},
			"Dia": {
				"type": "string",
				"defaultValue": "08"
			}
		},
		"folder": {
			"name": "dsa_Sap"
		},
		"annotations": []
	}
}