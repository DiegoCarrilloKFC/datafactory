{
	"name": "pl_dsa_Sap_Ecu_Catalogo_6",
	"properties": {
		"activities": [
			{
				"name": "FECHACARGA",
				"type": "SetVariable",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"variableName": "FECHACARGA",
					"value": {
						"value": "@Concat(pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia)",
						"type": "Expression"
					}
				}
			},
			{
				"name": "CSLT_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/CSLT",
							"wildcardFileName": {
								"value": "@Concat('CSLT_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[CSLT_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/CSLT"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "SPRAS",
									"type": "String"
								},
								{
									"name": "KOKRS",
									"type": "String"
								},
								{
									"name": "LSTAR",
									"type": "String"
								},
								{
									"name": "DATBI",
									"type": "String"
								},
								{
									"name": "KTEXT",
									"type": "String"
								},
								{
									"name": "LTEXT",
									"type": "String"
								},
								{
									"name": "MCTXT",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[CSLT_BLOB]"
						}
					}
				]
			},
			{
				"name": "CSLT",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "CSLT_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[CSLT]\nINSERT INTO [dsa_ecu_sap].[CSLT]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[CSLT_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteCSLT",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "CSLT",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/CSLT"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/CSLT"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "CSLA_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/CSLA",
							"wildcardFileName": {
								"value": "@Concat('CSLA_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[CSLA_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/CSLA"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "KOKRS",
									"type": "String"
								},
								{
									"name": "LSTAR",
									"type": "String"
								},
								{
									"name": "DATBI",
									"type": "String"
								},
								{
									"name": "DATAB",
									"type": "String"
								},
								{
									"name": "LEINH",
									"type": "String"
								},
								{
									"name": "LATYP",
									"type": "String"
								},
								{
									"name": "LATYPI",
									"type": "String"
								},
								{
									"name": "ERSDA",
									"type": "String"
								},
								{
									"name": "USNAM",
									"type": "String"
								},
								{
									"name": "KSTTY",
									"type": "String"
								},
								{
									"name": "AUSEH",
									"type": "String"
								},
								{
									"name": "AUSFK",
									"type": "Decimal"
								},
								{
									"name": "VKSTA",
									"type": "String"
								},
								{
									"name": "LARK1",
									"type": "String"
								},
								{
									"name": "LARK2",
									"type": "String"
								},
								{
									"name": "SPRKZ",
									"type": "String"
								},
								{
									"name": "HRKFT",
									"type": "String"
								},
								{
									"name": "FIXVO",
									"type": "String"
								},
								{
									"name": "TARKZ",
									"type": "String"
								},
								{
									"name": "YRATE",
									"type": "String"
								},
								{
									"name": "TARKZ_I",
									"type": "String"
								},
								{
									"name": "MANIST",
									"type": "String"
								},
								{
									"name": "MANPLAN",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[CSLA_BLOB]"
						}
					}
				]
			},
			{
				"name": "CSLA",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "CSLA_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[CSLA]\nINSERT INTO [dsa_ecu_sap].[CSLA]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[CSLA_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteCSLA",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "CSLA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/CSLA"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/CSLA"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "TJ02T_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/TJ02T",
							"wildcardFileName": {
								"value": "@Concat('TJ02T_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[TJ02T_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/TJ02T"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "ISTAT",
									"type": "String"
								},
								{
									"name": "SPRAS",
									"type": "String"
								},
								{
									"name": "TXT04",
									"type": "String"
								},
								{
									"name": "TXT30",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[TJ02T_BLOB]"
						}
					}
				]
			},
			{
				"name": "TJ02T",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "TJ02T_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[TJ02T]\nINSERT INTO [dsa_ecu_sap].[TJ02T]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[TJ02T_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteTJ02T",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "TJ02T",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/TJ02T"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/TJ02T"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "TSTCT_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/TSTCT",
							"wildcardFileName": {
								"value": "@Concat('TSTCT_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[TSTCT_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/TSTCT"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "SPRSL",
									"type": "String"
								},
								{
									"name": "TCODE",
									"type": "String"
								},
								{
									"name": "TTEXT",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[TSTCT_BLOB]"
						}
					}
				]
			},
			{
				"name": "TSTCT",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "TSTCT_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[TSTCT]\nINSERT INTO [dsa_ecu_sap].[TSTCT]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[TSTCT_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteTSTCT",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "TSTCT",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/TSTCT"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/TSTCT"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "USR21_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/USR21",
							"wildcardFileName": {
								"value": "@Concat('USR21_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[USR21_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/USR21"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "BNAME",
									"type": "String"
								},
								{
									"name": "PERSNUMBER",
									"type": "String"
								},
								{
									"name": "ADDRNUMBER",
									"type": "String"
								},
								{
									"name": "KOSTL",
									"type": "String"
								},
								{
									"name": "START_MENU",
									"type": "String"
								},
								{
									"name": "IDADTYPE",
									"type": "String"
								},
								{
									"name": "BPPERSON",
									"type": "String"
								},
								{
									"name": "ORGANIZATION",
									"type": "String"
								},
								{
									"name": "RESPONSIBLE",
									"type": "String"
								},
								{
									"name": "TECHDESC",
									"type": "String"
								},
								{
									"name": "IDENTITY_GUID",
									"type": "String"
								},
								{
									"name": "TEMPLATE_ORGTYPE",
									"type": "String"
								},
								{
									"name": "TEMPLATE_ORGADDR",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[USR21_BLOB]"
						}
					}
				]
			},
			{
				"name": "USR21",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "USR21_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[USR21]\nINSERT INTO [dsa_ecu_sap].[USR21]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[USR21_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteUSR21",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "USR21",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/USR21"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/USR21"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "ADRP_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/ADRP",
							"wildcardFileName": {
								"value": "@Concat('ADRP_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[ADRP_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/ADRP"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "CLIENT",
									"type": "String"
								},
								{
									"name": "PERSNUMBER",
									"type": "String"
								},
								{
									"name": "DATE_FROM",
									"type": "String"
								},
								{
									"name": "NATION",
									"type": "String"
								},
								{
									"name": "DATE_TO",
									"type": "String"
								},
								{
									"name": "TITLE",
									"type": "String"
								},
								{
									"name": "NAME_FIRST",
									"type": "String"
								},
								{
									"name": "NAME_LAST",
									"type": "String"
								},
								{
									"name": "NAME2",
									"type": "String"
								},
								{
									"name": "NAMEMIDDLE",
									"type": "String"
								},
								{
									"name": "NAME_LAST2",
									"type": "String"
								},
								{
									"name": "NAME_TEXT",
									"type": "String"
								},
								{
									"name": "CONVERTED",
									"type": "String"
								},
								{
									"name": "TITLE_ACA1",
									"type": "String"
								},
								{
									"name": "TITLE_ACA2",
									"type": "String"
								},
								{
									"name": "PREFIX1",
									"type": "String"
								},
								{
									"name": "PREFIX2",
									"type": "String"
								},
								{
									"name": "TITLE_SPPL",
									"type": "String"
								},
								{
									"name": "NICKNAME",
									"type": "String"
								},
								{
									"name": "INITIALS",
									"type": "String"
								},
								{
									"name": "NAMEFORMAT",
									"type": "String"
								},
								{
									"name": "NAMCOUNTRY",
									"type": "String"
								},
								{
									"name": "PROFESSION",
									"type": "String"
								},
								{
									"name": "SEX",
									"type": "String"
								},
								{
									"name": "LANGU",
									"type": "String"
								},
								{
									"name": "PERS_GROUP",
									"type": "String"
								},
								{
									"name": "FLAGGROUPS",
									"type": "String"
								},
								{
									"name": "SORT1",
									"type": "String"
								},
								{
									"name": "SORT2",
									"type": "String"
								},
								{
									"name": "SORT_PHN",
									"type": "String"
								},
								{
									"name": "ADDR_COMP",
									"type": "String"
								},
								{
									"name": "ADDR_PERS",
									"type": "String"
								},
								{
									"name": "FLPERSTEL",
									"type": "String"
								},
								{
									"name": "FLPERSCOMM",
									"type": "String"
								},
								{
									"name": "PERSORIGIN",
									"type": "String"
								},
								{
									"name": "MC_NAMEFIR",
									"type": "String"
								},
								{
									"name": "MC_NAMELAS",
									"type": "String"
								},
								{
									"name": "MC_NAME2",
									"type": "String"
								},
								{
									"name": "LANGU_CREA",
									"type": "String"
								},
								{
									"name": "ADRP_UUID",
									"type": "String"
								},
								{
									"name": "UUID_BELATED",
									"type": "String"
								},
								{
									"name": "ID_CATEGORY",
									"type": "String"
								},
								{
									"name": "ADRP_ERR_STATUS",
									"type": "String"
								},
								{
									"name": "_DATAAGING",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[ADRP_BLOB]"
						}
					}
				]
			},
			{
				"name": "ADRP",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "ADRP_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[ADRP]\nINSERT INTO [dsa_ecu_sap].[ADRP]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[ADRP_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteADRP",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "ADRP",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/ADRP"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/ADRP"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "ADCP_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/ADCP",
							"wildcardFileName": {
								"value": "@Concat('ADCP_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[ADCP_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/ADCP"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "CLIENT",
									"type": "String"
								},
								{
									"name": "ADDRNUMBER",
									"type": "String"
								},
								{
									"name": "PERSNUMBER",
									"type": "String"
								},
								{
									"name": "DATE_FROM",
									"type": "String"
								},
								{
									"name": "NATION",
									"type": "String"
								},
								{
									"name": "DATE_TO",
									"type": "String"
								},
								{
									"name": "COMP_PERS",
									"type": "String"
								},
								{
									"name": "SO_KEY",
									"type": "String"
								},
								{
									"name": "DEPARTMENT",
									"type": "String"
								},
								{
									"name": "FUNCTION",
									"type": "String"
								},
								{
									"name": "BUILDING",
									"type": "String"
								},
								{
									"name": "FLOOR",
									"type": "String"
								},
								{
									"name": "ROOMNUMBER",
									"type": "String"
								},
								{
									"name": "ID_CODE",
									"type": "String"
								},
								{
									"name": "IH_MAIL",
									"type": "String"
								},
								{
									"name": "SORT1",
									"type": "String"
								},
								{
									"name": "SORT2",
									"type": "String"
								},
								{
									"name": "SORT_PHN",
									"type": "String"
								},
								{
									"name": "ALT_COMPNY",
									"type": "String"
								},
								{
									"name": "DEFLT_COMM",
									"type": "String"
								},
								{
									"name": "TEL_NUMBER",
									"type": "String"
								},
								{
									"name": "TEL_EXTENS",
									"type": "String"
								},
								{
									"name": "FAX_NUMBER",
									"type": "String"
								},
								{
									"name": "FAX_EXTENS",
									"type": "String"
								},
								{
									"name": "FLAGCOMM2",
									"type": "String"
								},
								{
									"name": "FLAGCOMM3",
									"type": "String"
								},
								{
									"name": "FLAGCOMM4",
									"type": "String"
								},
								{
									"name": "FLAGCOMM5",
									"type": "String"
								},
								{
									"name": "FLAGCOMM6",
									"type": "String"
								},
								{
									"name": "FLAGCOMM7",
									"type": "String"
								},
								{
									"name": "FLAGCOMM8",
									"type": "String"
								},
								{
									"name": "FLAGCOMM9",
									"type": "String"
								},
								{
									"name": "FLAGCOMM10",
									"type": "String"
								},
								{
									"name": "FLAGCOMM11",
									"type": "String"
								},
								{
									"name": "FLAGCOMM12",
									"type": "String"
								},
								{
									"name": "FLAGCOMM13",
									"type": "String"
								},
								{
									"name": "ADCP_UUID",
									"type": "String"
								},
								{
									"name": "UUID_BELATED",
									"type": "String"
								},
								{
									"name": "ID_CATEGORY",
									"type": "String"
								},
								{
									"name": "ADCP_ERR_STATUS",
									"type": "String"
								},
								{
									"name": "XPCPT",
									"type": "String"
								},
								{
									"name": "_DATAAGING",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[ADCP_BLOB]"
						}
					}
				]
			},
			{
				"name": "ADCP",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "ADCP_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[ADCP]\nINSERT INTO [dsa_ecu_sap].[ADCP]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[ADCP_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteADCP",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "ADCP",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/ADCP"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/ADCP"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "FINSC_BTTYPE_T_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/FINSC_BTTYPE_T",
							"wildcardFileName": {
								"value": "@Concat('FINSC_BTTYPE_T_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[FINSC_BTTYPE_T_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FINSC_BTTYPE_T"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "LANGU",
									"type": "String"
								},
								{
									"name": "BTTYPE",
									"type": "String"
								},
								{
									"name": "TXT",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[FINSC_BTTYPE_T_BLOB]"
						}
					}
				]
			},
			{
				"name": "FINSC_BTTYPE_T",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "FINSC_BTTYPE_T_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[FINSC_BTTYPE_T]\nINSERT INTO [dsa_ecu_sap].[FINSC_BTTYPE_T]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[FINSC_BTTYPE_T_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteFINSC_BTTYPE_T",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "FINSC_BTTYPE_T",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FINSC_BTTYPE_T"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/FINSC_BTTYPE_T"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "FAGL_011PC_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/FAGL_011PC",
							"wildcardFileName": {
								"value": "@Concat('FAGL_011PC_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[FAGL_011PC_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011PC"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "VERSN",
									"type": "String"
								},
								{
									"name": "ID",
									"type": "String"
								},
								{
									"name": "TYPE",
									"type": "String"
								},
								{
									"name": "ERGSL",
									"type": "String"
								},
								{
									"name": "PARENT",
									"type": "String"
								},
								{
									"name": "CHILD",
									"type": "String"
								},
								{
									"name": "NEXTN",
									"type": "String"
								},
								{
									"name": "STUFE",
									"type": "String"
								},
								{
									"name": "SUMME",
									"type": "String"
								},
								{
									"name": "SIGN",
									"type": "String"
								},
								{
									"name": "AEDAT",
									"type": "String"
								},
								{
									"name": "USNAM",
									"type": "String"
								},
								{
									"name": "AETIM",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[FAGL_011PC_BLOB]"
						}
					}
				]
			},
			{
				"name": "FAGL_011PC",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "FAGL_011PC_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[FAGL_011PC]\nINSERT INTO [dsa_ecu_sap].[FAGL_011PC]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[FAGL_011PC_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteFAGL_011PC",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "FAGL_011PC",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011PC"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/FAGL_011PC"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "FAGL_011PCI_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/FAGL_011PCI",
							"wildcardFileName": {
								"value": "@Concat('FAGL_011PCI_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[FAGL_011PCI_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011PCI"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "VERSN",
									"type": "String"
								},
								{
									"name": "ID",
									"type": "String"
								},
								{
									"name": "TYPE",
									"type": "String"
								},
								{
									"name": "PARENT",
									"type": "String"
								},
								{
									"name": "CHILD",
									"type": "String"
								},
								{
									"name": "NEXTN",
									"type": "String"
								},
								{
									"name": "STUFE",
									"type": "String"
								},
								{
									"name": "SUMME",
									"type": "String"
								},
								{
									"name": "SIGN",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[FAGL_011PCI_BLOB]"
						}
					}
				]
			},
			{
				"name": "FAGL_011PCI",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "FAGL_011PCI_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[FAGL_011PCI]\nINSERT INTO [dsa_ecu_sap].[FAGL_011PCI]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[FAGL_011PCI_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteFAGL_011PCI",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "FAGL_011PCI",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011PCI"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/FAGL_011PCI"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "FAGL_011ZC_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/FAGL_011ZC",
							"wildcardFileName": {
								"value": "@Concat('FAGL_011ZC_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[FAGL_011ZC_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011ZC"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "VERSN",
									"type": "String"
								},
								{
									"name": "ERGSL",
									"type": "String"
								},
								{
									"name": "KTOPL",
									"type": "String"
								},
								{
									"name": "VONKT",
									"type": "String"
								},
								{
									"name": "BISKT",
									"type": "String"
								},
								{
									"name": "XSOLL",
									"type": "String"
								},
								{
									"name": "XHABN",
									"type": "String"
								},
								{
									"name": "XVERD",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[FAGL_011ZC_BLOB]"
						}
					}
				]
			},
			{
				"name": "FAGL_011ZC",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "FAGL_011ZC_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[FAGL_011ZC]\nINSERT INTO [dsa_ecu_sap].[FAGL_011ZC]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[FAGL_011ZC_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteFAGL_011ZC",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "FAGL_011ZC",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011ZC"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/FAGL_011ZC"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			},
			{
				"name": "FAGL_011QT_BLOB",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "FECHACARGA",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "AzureBlobStorageReadSettings",
							"recursive": true,
							"wildcardFolderPath": "catalogo/FAGL_011QT",
							"wildcardFileName": {
								"value": "@Concat('FAGL_011QT_',pipeline().parameters.Anio,pipeline().parameters.Mes,pipeline().parameters.Dia,'_','*.txt')",
								"type": "Expression"
							}
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "truncate table [dsa_ecu_sap].[FAGL_011QT_BLOB]",
						"disableMetricsCollection": false
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_BlobSap",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011QT"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "MANDT",
									"type": "String"
								},
								{
									"name": "VERSN",
									"type": "String"
								},
								{
									"name": "SPRAS",
									"type": "String"
								},
								{
									"name": "ERGSL",
									"type": "String"
								},
								{
									"name": "TXTYP",
									"type": "String"
								},
								{
									"name": "ZEILE",
									"type": "String"
								},
								{
									"name": "TXT45",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_ecu_sap].[FAGL_011QT_BLOB]"
						}
					}
				]
			},
			{
				"name": "FAGL_011QT",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "FAGL_011QT_BLOB",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "TRUNCATE TABLE [dsa_ecu_sap].[FAGL_011QT]\nINSERT INTO [dsa_ecu_sap].[FAGL_011QT]\nSELECT '@{variables('FECHACARGA')}' ,* FROM [dsa_ecu_sap].[FAGL_011QT_BLOB]\nSELECT 'ok' AS Resultado",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "ds_dwh_general",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "DeleteFAGL_011QT",
				"type": "Delete",
				"dependsOn": [
					{
						"activity": "FAGL_011QT",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "ds_BlobSap_Delete",
						"type": "DatasetReference",
						"parameters": {
							"cw_carpeta": "catalogo/FAGL_011QT"
						}
					},
					"logStorageSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "almacenamientosap/catalogo/FAGL_011QT"
					},
					"enableLogging": true,
					"storeSettings": {
						"type": "AzureBlobStorageReadSettings",
						"recursive": true,
						"modifiedDatetimeEnd": {
							"value": "@adddays(pipeline().TriggerTime,-7)",
							"type": "Expression"
						},
						"enablePartitionDiscovery": false
					}
				}
			}
		],
		"parameters": {
			"Anio": {
				"type": "string",
				"defaultValue": "2021"
			},
			"Mes": {
				"type": "string",
				"defaultValue": "07"
			},
			"Dia": {
				"type": "string",
				"defaultValue": "23"
			}
		},
		"variables": {
			"FECHACARGA": {
				"type": "String"
			}
		},
		"folder": {
			"name": "dsa_Sap"
		},
		"annotations": []
	}
}