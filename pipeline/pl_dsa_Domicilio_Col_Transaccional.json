{
	"name": "pl_dsa_Domicilio_Col_Transaccional",
	"properties": {
		"activities": [
			{
				"name": "Cabecera_FacturaDomicilio",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Cabecera_FacturaDomicilio]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Cabecera_FacturaDomicilio]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Restaurante,Estado_Transferencia,Fecha,Comentario_Factura,Estado,Cod_Telefono,Ruc_Cedula FROM dbo.Cabecera_Factura WHERE CAST(Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Cabecera_FacturaDomicilio]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "Int32"
								},
								{
									"name": "Cod_Restaurante",
									"type": "Int32"
								},
								{
									"name": "Estado_Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								},
								{
									"name": "Comentario_Factura",
									"type": "String"
								},
								{
									"name": "Estado",
									"type": "Int32"
								},
								{
									"name": "Cod_Telefono",
									"type": "Int64"
								},
								{
									"name": "Ruc_Cedula",
									"type": "String"
								}
							],
							"cw_tableName": "[dbo].[Cabecera_Factura]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilio",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "Int32"
								},
								{
									"name": "Cod_Restaurante",
									"type": "Int32"
								},
								{
									"name": "Estado_Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								},
								{
									"name": "Comentario_Factura",
									"type": "String"
								},
								{
									"name": "Estado",
									"type": "Int32"
								},
								{
									"name": "Cod_Telefono",
									"type": "Int64"
								},
								{
									"name": "Ruc_Cedula",
									"type": "String"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Cabecera_FacturaDomicilio]"
						}
					}
				]
			},
			{
				"name": "Detalle_FacturaDomicilio",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Detalle_FacturaDomicilio]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Detalle_FacturaDomicilio]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cantidad,det.Precio,det.Iva FROM dbo.Detalle_Factura det INNER JOIN dbo.Cabecera_Factura cab ON det.Cod_Factura=cab.Cod_Factura WHERE CAST(cab.Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Detalle_FacturaDomicilio]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "Cod_Detalle_Factura",
									"type": "Guid"
								},
								{
									"name": "Cod_Factura",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Int32"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								}
							],
							"cw_tableName": "[dbo].[Detalle_Factura]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilio",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "Cod_Detalle_Factura",
									"type": "Guid"
								},
								{
									"name": "Cod_Factura",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Int32"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Detalle_FacturaDomicilio]"
						}
					}
				]
			},
			{
				"name": "Detalle_Factura",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Detalle_Factura]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Detalle_Factura]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden FROM dbo.Detalle_Factura det INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Detalle_Factura]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu_Promocion",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Double"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								},
								{
									"name": "Costo",
									"type": "Double"
								},
								{
									"name": "Orden",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dbo].[Detalle_Factura]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu_Promocion",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Double"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								},
								{
									"name": "Costo",
									"type": "Double"
								},
								{
									"name": "Orden",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Detalle_Factura]"
						}
					}
				]
			},
			{
				"name": "Factura_Anulacion",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Anulacion]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Anulacion]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Anulacion]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Motivo",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Observacion",
									"type": "String"
								},
								{
									"name": "Fecha_anulacion",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dbo].[Factura_Anulacion]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Motivo",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Observacion",
									"type": "String"
								},
								{
									"name": "Fecha_anulacion",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Anulacion]"
						}
					}
				]
			},
			{
				"name": "Factura_Domicilio",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Domicilio]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Domicilio]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo FROM dbo.Factura_Domicilio fac INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Domicilio]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Restaurante",
									"type": "Int32"
								},
								{
									"name": "Cod_Cliente_Domicilio",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Usuario",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Estado_Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								},
								{
									"name": "Comentario",
									"type": "String"
								},
								{
									"name": "Estado",
									"type": "Int32"
								},
								{
									"name": "Consumidor_Final",
									"type": "Int32"
								},
								{
									"name": "Cod_Telefono",
									"type": "Int64"
								},
								{
									"name": "Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha_Creacion",
									"type": "DateTime"
								},
								{
									"name": "DescuentoIVA",
									"type": "Double"
								},
								{
									"name": "DescuentoNoIVA",
									"type": "Double"
								},
								{
									"name": "Direccion_Alterna",
									"type": "String"
								},
								{
									"name": "Porcentaje",
									"type": "Double"
								},
								{
									"name": "Cod_Usuario_Descto",
									"type": "Int32"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "Serie_Dian",
									"type": "Int32"
								},
								{
									"name": "Cod_Nota_Credito",
									"type": "String"
								},
								{
									"name": "Tipo_Facturacion",
									"type": "Int32"
								},
								{
									"name": "Cod_Tipo_Comprobante",
									"type": "Int32"
								},
								{
									"name": "Clave_Acceso",
									"type": "String"
								},
								{
									"name": "Numero_Factura",
									"type": "String"
								},
								{
									"name": "Autorizado",
									"type": "Int32"
								},
								{
									"name": "Datos_Adicionales",
									"type": "String"
								},
								{
									"name": "FechaOperacion",
									"type": "DateTime"
								},
								{
									"name": "numeroAutorizacion",
									"type": "String"
								},
								{
									"name": "ControlPendientes",
									"type": "String"
								},
								{
									"name": "Compensacion",
									"type": "Double"
								},
								{
									"name": "Cod_AppMovil",
									"type": "String"
								},
								{
									"name": "guiaTracking",
									"type": "String"
								},
								{
									"name": "TotalBruto",
									"type": "Double"
								},
								{
									"name": "Subtotal",
									"type": "Double"
								},
								{
									"name": "IvaTotal",
									"type": "Double"
								},
								{
									"name": "SubCero",
									"type": "Double"
								},
								{
									"name": "SubImpuesto",
									"type": "Double"
								},
								{
									"name": "Medio",
									"type": "String"
								},
								{
									"name": "Dispositivo",
									"type": "String"
								},
								{
									"name": "FechaPeriodo",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dbo].[Factura_Domicilio]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Restaurante",
									"type": "Int32"
								},
								{
									"name": "Cod_Cliente_Domicilio",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Usuario",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Estado_Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								},
								{
									"name": "Comentario",
									"type": "String"
								},
								{
									"name": "Estado",
									"type": "Int32"
								},
								{
									"name": "Consumidor_Final",
									"type": "Int32"
								},
								{
									"name": "Cod_Telefono",
									"type": "Int64"
								},
								{
									"name": "Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha_Creacion",
									"type": "DateTime"
								},
								{
									"name": "DescuentoIVA",
									"type": "Double"
								},
								{
									"name": "DescuentoNoIVA",
									"type": "Double"
								},
								{
									"name": "Direccion_Alterna",
									"type": "String"
								},
								{
									"name": "Porcentaje",
									"type": "Double"
								},
								{
									"name": "Cod_Usuario_Descto",
									"type": "Int32"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "Serie_Dian",
									"type": "Int32"
								},
								{
									"name": "Cod_Nota_Credito",
									"type": "String"
								},
								{
									"name": "Tipo_Facturacion",
									"type": "Int32"
								},
								{
									"name": "Cod_Tipo_Comprobante",
									"type": "Int32"
								},
								{
									"name": "Clave_Acceso",
									"type": "String"
								},
								{
									"name": "Numero_Factura",
									"type": "String"
								},
								{
									"name": "Autorizado",
									"type": "Int32"
								},
								{
									"name": "Datos_Adicionales",
									"type": "String"
								},
								{
									"name": "FechaOperacion",
									"type": "DateTime"
								},
								{
									"name": "numeroAutorizacion",
									"type": "String"
								},
								{
									"name": "ControlPendientes",
									"type": "String"
								},
								{
									"name": "Compensacion",
									"type": "Double"
								},
								{
									"name": "Cod_AppMovil",
									"type": "String"
								},
								{
									"name": "guiaTracking",
									"type": "String"
								},
								{
									"name": "TotalBruto",
									"type": "Double"
								},
								{
									"name": "Subtotal",
									"type": "Double"
								},
								{
									"name": "IvaTotal",
									"type": "Double"
								},
								{
									"name": "SubCero",
									"type": "Double"
								},
								{
									"name": "SubImpuesto",
									"type": "Double"
								},
								{
									"name": "Medio",
									"type": "String"
								},
								{
									"name": "Dispositivo",
									"type": "String"
								},
								{
									"name": "FechaPeriodo",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Domicilio]"
						}
					}
				]
			},
			{
				"name": "Factura_FormasPago",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_FormasPago]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_FormasPago]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx FROM dbo.Factura_FormasPago ffp INNER JOIN dbo.Factura_Domicilio fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_FormasPago]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_FFormasPago",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_FormaPago",
									"type": "Int32"
								},
								{
									"name": "Num_Tarjeta",
									"type": "String"
								},
								{
									"name": "Num_Seguridad",
									"type": "String"
								},
								{
									"name": "Fecha_Caducidad",
									"type": "String"
								},
								{
									"name": "Billete",
									"type": "Double"
								},
								{
									"name": "NumeroCheque",
									"type": "String"
								},
								{
									"name": "Banco",
									"type": "String"
								},
								{
									"name": "Titular",
									"type": "String"
								},
								{
									"name": "Referencia_Billete",
									"type": "String"
								},
								{
									"name": "Valor_Billete",
									"type": "Double"
								},
								{
									"name": "Total_Pagar",
									"type": "Double"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "ClienteAx",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dbo].[Factura_FormasPago]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_FFormasPago",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_FormaPago",
									"type": "Int32"
								},
								{
									"name": "Num_Tarjeta",
									"type": "String"
								},
								{
									"name": "Num_Seguridad",
									"type": "String"
								},
								{
									"name": "Fecha_Caducidad",
									"type": "String"
								},
								{
									"name": "Billete",
									"type": "Double"
								},
								{
									"name": "NumeroCheque",
									"type": "String"
								},
								{
									"name": "Banco",
									"type": "String"
								},
								{
									"name": "Titular",
									"type": "String"
								},
								{
									"name": "Referencia_Billete",
									"type": "String"
								},
								{
									"name": "Valor_Billete",
									"type": "Double"
								},
								{
									"name": "Total_Pagar",
									"type": "Double"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "ClienteAx",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_FormasPago]"
						}
					}
				]
			},
			{
				"name": "Factura_Motorolo",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Motorolo]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Motorolo]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo fmo INNER JOIN dbo.Factura_Domicilio fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Motorolo]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Estado",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dbo].[Factura_Motorolo]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Estado",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Motorolo]"
						}
					}
				]
			},
			{
				"name": "Modificador_Detalle_Factura",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Modificador_Detalle_Factura]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Modificador_Detalle_Factura]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura mdf INNER JOIN dbo.Detalle_Factura det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Modificador_Detalle_Factura]",
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						}
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Modificador",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dbo].[Modificador_Detalle_Factura]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Modificador",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Modificador_Detalle_Factura]"
						}
					}
				]
			},
			{
				"name": "Detalle_Factura_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Detalle_Factura",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Detalle_Factura]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Detalle_Factura]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden FROM dbo.Detalle_Factura det INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >= '20220401'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu_Promocion",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Double"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								},
								{
									"name": "Costo",
									"type": "Double"
								},
								{
									"name": "Orden",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dbo].[Detalle_Factura]",
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Plu",
									"type": "Int32"
								},
								{
									"name": "Cod_Plu_Promocion",
									"type": "Int32"
								},
								{
									"name": "Cantidad",
									"type": "Double"
								},
								{
									"name": "Precio",
									"type": "Double"
								},
								{
									"name": "Iva",
									"type": "Double"
								},
								{
									"name": "Costo",
									"type": "Double"
								},
								{
									"name": "Orden",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Detalle_Factura]"
						}
					}
				]
			},
			{
				"name": "Factura_Anulacion_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Factura_Anulacion",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Anulacion]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Anulacion]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Motivo",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Observacion",
									"type": "String"
								},
								{
									"name": "Fecha_anulacion",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Anulacion]"
						}
					}
				]
			},
			{
				"name": "Factura_Domicilio_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Factura_Domicilio",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Domicilio]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Domicilio]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo FROM dbo.Factura_Domicilio fac INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Restaurante",
									"type": "Int32"
								},
								{
									"name": "Cod_Cliente_Domicilio",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Usuario",
									"type": "Int32"
								},
								{
									"name": "Cod_Administrador",
									"type": "Int32"
								},
								{
									"name": "Estado_Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								},
								{
									"name": "Comentario",
									"type": "String"
								},
								{
									"name": "Estado",
									"type": "Int32"
								},
								{
									"name": "Consumidor_Final",
									"type": "Int32"
								},
								{
									"name": "Cod_Telefono",
									"type": "Int64"
								},
								{
									"name": "Transferencia",
									"type": "Int32"
								},
								{
									"name": "Fecha_Creacion",
									"type": "DateTime"
								},
								{
									"name": "DescuentoIVA",
									"type": "Double"
								},
								{
									"name": "DescuentoNoIVA",
									"type": "Double"
								},
								{
									"name": "Direccion_Alterna",
									"type": "String"
								},
								{
									"name": "Porcentaje",
									"type": "Double"
								},
								{
									"name": "Cod_Usuario_Descto",
									"type": "Int32"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "Serie_Dian",
									"type": "Int32"
								},
								{
									"name": "Cod_Nota_Credito",
									"type": "String"
								},
								{
									"name": "Tipo_Facturacion",
									"type": "Int32"
								},
								{
									"name": "Cod_Tipo_Comprobante",
									"type": "Int32"
								},
								{
									"name": "Clave_Acceso",
									"type": "String"
								},
								{
									"name": "Numero_Factura",
									"type": "String"
								},
								{
									"name": "Autorizado",
									"type": "Int32"
								},
								{
									"name": "Datos_Adicionales",
									"type": "String"
								},
								{
									"name": "FechaOperacion",
									"type": "DateTime"
								},
								{
									"name": "numeroAutorizacion",
									"type": "String"
								},
								{
									"name": "ControlPendientes",
									"type": "String"
								},
								{
									"name": "Compensacion",
									"type": "Double"
								},
								{
									"name": "Cod_AppMovil",
									"type": "String"
								},
								{
									"name": "guiaTracking",
									"type": "String"
								},
								{
									"name": "TotalBruto",
									"type": "Double"
								},
								{
									"name": "Subtotal",
									"type": "Double"
								},
								{
									"name": "IvaTotal",
									"type": "Double"
								},
								{
									"name": "SubCero",
									"type": "Double"
								},
								{
									"name": "SubImpuesto",
									"type": "Double"
								},
								{
									"name": "Medio",
									"type": "String"
								},
								{
									"name": "Dispositivo",
									"type": "String"
								},
								{
									"name": "FechaPeriodo",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Domicilio]"
						}
					}
				]
			},
			{
				"name": "Factura_FormasPago_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Factura_FormasPago",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_FormasPago]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_FormasPago]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx FROM dbo.Factura_FormasPago ffp INNER JOIN dbo.Factura_Domicilio fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_FFormasPago",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_FormaPago",
									"type": "Int32"
								},
								{
									"name": "Num_Tarjeta",
									"type": "String"
								},
								{
									"name": "Num_Seguridad",
									"type": "String"
								},
								{
									"name": "Fecha_Caducidad",
									"type": "String"
								},
								{
									"name": "Billete",
									"type": "Double"
								},
								{
									"name": "NumeroCheque",
									"type": "String"
								},
								{
									"name": "Banco",
									"type": "String"
								},
								{
									"name": "Titular",
									"type": "String"
								},
								{
									"name": "Referencia_Billete",
									"type": "String"
								},
								{
									"name": "Valor_Billete",
									"type": "Double"
								},
								{
									"name": "Total_Pagar",
									"type": "Double"
								},
								{
									"name": "Propina",
									"type": "Double"
								},
								{
									"name": "ClienteAx",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_FormasPago]"
						}
					}
				]
			},
			{
				"name": "Factura_Motorolo_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Factura_Motorolo",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Factura_Motorolo]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Factura_Motorolo]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo fmo INNER JOIN dbo.Factura_Domicilio fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Motorolo",
									"type": "Int32"
								},
								{
									"name": "Cod_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Periodo",
									"type": "String"
								},
								{
									"name": "Cod_Estado",
									"type": "Int32"
								},
								{
									"name": "Fecha",
									"type": "DateTime"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Factura_Motorolo]"
						}
					}
				]
			},
			{
				"name": "Modificador_Detalle_Factura_server_2",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Modificador_Detalle_Factura",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 2,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "[dbo].[Modificador_Detalle_Factura]"
					},
					{
						"name": "Destination",
						"value": "[dsa_col_domi].[Modificador_Detalle_Factura]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": {
							"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura mdf INNER JOIN dbo.Detalle_Factura det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "SqlDWSink",
						"writeBatchSize": 10000,
						"allowPolyBase": true,
						"polyBaseSettings": {
							"rejectValue": 0,
							"rejectType": "value",
							"useTypeDefault": true
						},
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "linked_storage",
							"type": "LinkedServiceReference"
						},
						"path": "contenedor"
					}
				},
				"inputs": [
					{
						"referenceName": "ds_DomicilioCol_2",
						"type": "DatasetReference",
						"parameters": {
							"cw_servidor": {
								"value": "@pipeline().parameters.Servidor2",
								"type": "Expression"
							},
							"cw_baseDatos": {
								"value": "@pipeline().parameters.BaseDatosDomicilioGerente2",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "ds_dwh",
						"type": "DatasetReference",
						"parameters": {
							"cw_structure": [
								{
									"name": "FechaCarga",
									"type": "DateTime"
								},
								{
									"name": "Cod_Detalle_Factura",
									"type": "String"
								},
								{
									"name": "Cod_Modificador",
									"type": "Int32"
								}
							],
							"cw_tableName": "[dsa_col_domi].[Modificador_Detalle_Factura]"
						}
					}
				]
			}
		],
		"parameters": {
			"Servidor": {
				"type": "string",
				"defaultValue": "SAZGERENTECOL\\DomicilioCol"
			},
			"BaseDatosDomicilio": {
				"type": "string",
				"defaultValue": "Domicilio"
			},
			"BaseDatosDomicilioWeb": {
				"type": "string",
				"defaultValue": "DomicilioWeb"
			},
			"BaseDatosDomicilioGerente": {
				"type": "string",
				"defaultValue": "SqlGerenteDom"
			},
			"FechaDesde": {
				"type": "string"
			},
			"FechaHasta": {
				"type": "string"
			},
			"Servidor2": {
				"type": "string",
				"defaultValue": "192.168.179.112\\DomicilioCol"
			},
			"BaseDatosDomicilioGerente2": {
				"type": "string",
				"defaultValue": "SqlGerenteDom"
			}
		},
		"folder": {
			"name": "dsa_DomicilioCol"
		},
		"annotations": []
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}