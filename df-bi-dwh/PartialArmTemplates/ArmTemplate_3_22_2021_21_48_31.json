{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "df-bi-dwh"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/pl_Carga_Multipais')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Carga DSA SG Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA AX Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_DynamicsAx_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA MP Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Maxpoint_Ecu_Drive",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_dwh_suscripcion"
							}
						}
					},
					{
						"name": "Carga Dimension",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga DSA SG Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Col",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Chl",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA AX Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA MP Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA Conta Reg",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA Sip Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Arg",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA DOM Chl",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SAP",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Dimensiones",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ALL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Operacion Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Plantas Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Planta_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Operacion Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA DOM Col",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "COL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Operacion Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "CHL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG INV Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_CAR_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Col",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Auditoria_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "COL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Chl",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Auditoria_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "CHL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Inicializar Etapas",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Escalar DWH",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "EXEC [dsa_int_lst].[usp_CargaTabla]\nEXEC [dsa_int_lst].[usp_CargaDependenciaTabla]\nEXEC [admin_btc].[usp_CargaTabla]\nEXEC [admin_btc].[usp_CargaDependenciaTabla]\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'ECU'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'ECU'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'ECU'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'COL'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'COL'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'COL'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'CHL'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'CHL'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'CHL'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'ARG'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'ARG'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'ARG'\n\n--Control de Cargas\nTRUNCATE TABLE admin_btc.CargaDataFactory\n\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA VENTA-CAR-PLANTA',DATEADD(HH,-5,GETDATE()),NULL,0\n\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA ARGENTINA',DATEADD(HH,-5,GETDATE()),NULL,0\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga DSA DOM Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Domicilio_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Recarga Permisologia",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Escalar DWH",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_App_Seguridad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_admin_Bi"
							}
						}
					},
					{
						"name": "Carga Info Sus Dim",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Dimension",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Info_Suscripcion_Proceso",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Proceso": "DIMENSION",
								"SP": "admin_btc.usp_CargaInfoSuscripcion_Dimension"
							}
						}
					},
					{
						"name": "Carga DSA Conta Reg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_App_ContabilidadRegional",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "SharePoint_ListaExterna"
							}
						}
					},
					{
						"name": "Finalizar Carga Venta",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Carga CAR Chl",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Plantas Venta Embutser",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Operaciones POS Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA VENTA-CAR-PLANTA'\n\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA ARGENTINA'\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga Plantas Venta Embutser",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Plantas Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Operacion Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Planta_Ecu_Venta_Embutser",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga DSA Sip Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Sip_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG INV Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Ecu_Transaccional_Inventario",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Escalar DWH",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_admin_Escalar_DWH",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"DWU": "DW1000c"
							}
						}
					},
					{
						"name": "Carga Cinnabon Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Cinnabon",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Inicializar Info Suscripcion",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Escalar DWH",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_CargaInfoSuscripcion_Inicializa]"
						},
						"linkedServiceName": {
							"referenceName": "linked_sharepoint",
							"type": "LinkedServiceReference",
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_dwh_suscripcion"
							}
						}
					},
					{
						"name": "Carga Operaciones POS Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_POS_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga DSA SG Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga Operacion Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ARG",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Arg",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Auditoria_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ARG",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Inicializar Carga Uyc",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Finalizar Carga Venta",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA USO CONSUMO ECU',DATEADD(HH,-5,GETDATE()),NULL,0\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga Operacion UyC Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Carga Uyc",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_UyC_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Reescalar DWH 2",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Tiempo Espera Log",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_admin_Escalar_DWH",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"DWU": "DW100c"
							}
						}
					},
					{
						"name": "Finalizar Carga UyC",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Reescalar DWH 2",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA USO CONSUMO ECU'\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Verificar Proceso Cubos Venta",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Carga Operacion UyC Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Verificar Carga Venta').output.firstRow.Resultado, 'OK')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Verificar Carga Venta",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Espera",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "IF EXISTS(SELECT * FROM admin_btc.CargaDataFactory WHERE Proceso = 'PROCESO SSAS VENTA-CAR-PLANTA' AND Estado = 1)\n\tSELECT 'OK' AS Resultado\nELSE\n\tSELECT 'REINTENTAR' AS Resultado",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "ds_dwh_general",
											"type": "DatasetReference"
										}
									}
								},
								{
									"name": "Espera",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 180
									}
								}
							],
							"timeout": "00.12:00:00"
						}
					},
					{
						"name": "Tiempo Espera Log",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Verificar Proceso Cubos Venta",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 800
						}
					},
					{
						"name": "Carga DSA DOM Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Domicilio_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Sap_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Tiempos Domicilio",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [dsa_ecu_sg].[Consolidado_DomicilioTiempos]\n\n--RANGO DE FECHAS\nDECLARE @FechaDesde DATETIME = CAST(GETDATE()-30 AS DATE)\nDECLARE @FechaHasta DATETIME = CAST(GETDATE() AS DATE)\n\n--INSERTAR DATOS\nINSERT INTO [dsa_ecu_sg].[Consolidado_DomicilioTiempos] \nSELECT\n\t'20210322',\n\tCAST(SUBSTRING(Final.cod_factura,6,14)AS INT)AS Factura,\n\tFinal.cod_telefono,\n\tCliente,\n\tCod_ZipCode,\n\tMotorizado,\n\tDespachador,\n\ttotal,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS Hora,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignada,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS Llegada,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS HoraC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignadaC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS LlegadaC,\n\tfinal.fecha,\n\tfinal.Cod_Restaurante,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS CreacionC,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS Creacion,\n\tYEAR(Fecha_Factura) AS Anio,\n\t'' AS Region,\n\tCASE WHEN fac.Cod_AppMovil is null THEN isnull(fac.Medio,'Llamada') ELSE isnull(fac.Medio,'App') END  AS Tipo_Pedido,\n\tCASE WHEN Dispositivo is null THEN '-' ELSE Dispositivo END Dispositivo\nFROM\n\t(\n\t\tSELECT\n\t\t\tCodigoCentroCosto,\n\t\t\tCod_Restaurante,\n\t\t\tfecha,\n\t\t\tcod_factura,\n\t\t\tcod_telefono,\n\t\t\tCliente,\n\t\t\tCod_ZipCode,\n\t\t\tMotorizado,\n\t\t\tDespachador,\n\t\t\ttotal,\n\t\t\tFecha_Factura,\n\t\t\tFecha_Creacion,\n\t\t\t[3] AS ASignada,\n\t\t\t[1] AS Llegada\n\t\tFROM\n\t\t\t( \n\t\t\tSELECT\n\t\t\t\tper.CodigoCentroCosto,\n\t\t\t\tper.fecha,\n\t\t\t\tfd.cod_factura,\n\t\t\t\tfd.cod_telefono,\n\t\t\t\t(cl.Nombres+SPACE(1)+cl.Apellidos) AS Cliente,\n\t\t\t\tInm.Cod_ZipCode,\n\t\t\t\t(mo.Nombres+SPACE(1)+mo.Apellidos) AS Motorizado,\n\t\t\t\tUPPER(us.Usuario) AS Despachador,\n\t\t\t\tfd.TotalBruto AS total,\n\t\t\t\tfd.fecha AS Fecha_Factura,\n\t\t\t\tfm.fecha AS tiempos,\n\t\t\t\tfm.cod_estado,\n\t\t\t\tfd.Fecha_Creacion,\n\t\t\t\tper.Cod_Restaurante\t\t\t\t\n\t\t\t\tFROM pos_ecu_domi.factura_domicilio AS fd\n\t\t\t\t\tINNER JOIN pos_ecu_domi.periodo AS per ON fd.cod_periodo = per.cod_periodo and fd.CodigoCentroCosto = per.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Cliente_Domicilio AS cl ON fd.Cod_Cliente_Domicilio = cl.Cod_Cliente_Domicilio and cl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Telefonos AS tl ON fd.Cod_Telefono = tl.Cod_Telefono and tl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Inmueble AS Inm ON tl.Cod_inmueble = Inm.Cod_inmueble and inm.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Factura_Motorolo AS fm ON fd.cod_factura = fm.cod_factura and fm.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Motorolos AS mo ON fm.Cod_Motorolo = mo.Cod_Motorolo and mo.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tleft JOIN pos_ecu_domi.Users AS us ON fd.cod_usuario = us.cod_usuario\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Restaurante AS res ON per.Cod_Restaurante  = res.Cod_Restaurante\n\t\t\t\t\tWHERE fd.Estado = 4 AND fm.Cod_estado = 1 or fm.Cod_estado = 3 AND per.Fecha >= @FechaDesde and per.Fecha < @FechaHasta\n\t\t\t\t) dom\n\t\tPIVOT (MAX(Tiempos) FOR cod_estado in ([1] ,[3]) ) AS pv) Final\n\t\tINNER JOIN pos_ecu_domi.Factura_Domicilio fac ON Final.Cod_factura = fac.Cod_Factura AND fac.CodigoCentroCosto = final.CodigoCentroCosto\n\t\tWHERE ASignada IS NOT NULL\nUNION ALL\nSELECT \n\t'20210316',\n\tCAST(SUBSTRING(Final.cod_factura,6,14)AS INT)AS Factura,\n\t0 as cod_telefono,\n\tSUBSTRING(Cliente,1,150),\n\tSUBSTRING(Cod_ZipCode,1,15),\n\tSUBSTRING(Motorizado,1,150),\n\tSUBSTRING(Despachador,1,20),\n\ttotal,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS Hora,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignada,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS Llegada,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS HoraC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignadaC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS LlegadaC,\n\tfinal.fecha,\n\tfinal.Cod_Restaurante,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS CreacionC,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS Creacion,\n\tYEAR(Fecha_Factura) AS Anio,\n\t'' AS Region,\n\t'' AS Tipo_Pedido, --CASE WHEN fac.Cod_AppMovil is null THEN isnull(fac.Medio,'Llamada') ELSE isnull(fac.Medio,'App') END  AS Tipo_Pedido,\n\t'' AS Dispositivo --CASE WHEN Dispositivo is null THEN '-' ELSE Dispositivo END Dispositivo\nFROM\n\t(\n\t\tSELECT\n\t\t\tCodigoCentroCosto,\n\t\t\tCod_Restaurante,\n\t\t\tfecha,\n\t\t\tcod_factura,\n\t\t\tcod_telefono,\n\t\t\tCliente,\n\t\t\tCod_ZipCode,\n\t\t\tMotorizado,\n\t\t\tDespachador,\n\t\t\ttotal,\n\t\t\tFecha_Factura,\n\t\t\tFecha_Creacion,\n\t\t\t[EN CAMINO] AS ASignada,\n\t\t\t[ENTREGADO] AS Llegada\n\t\tFROM\n\t\t\t( \n\t\t\tSELECT \n\t\t\t\tper.CodigoCentroCosto,\n\t\t\t\tper.prd_fechaapertura AS Fecha,\n\t\t\t\tfd.cfac_id AS cod_factura,\n\t\t\t\tcl.cli_telefono AS cod_telefono,\n\t\t\t\t(cl.cli_nombres+SPACE(1)+cl.cli_apellidos) AS Cliente,\n\t\t\t\tISNULL(ca.cod_ZipCode,'') AS Cod_ZipCode,\n\t\t\t\t'' AS Motorizado,--(mo.Nombres+SPACE(1)+mo.Apellidos) AS Motorizado,\n\t\t\t\tUPPER(us.usr_descripcion) AS Despachador,\n\t\t\t\tfd.cfac_total AS total,\n\t\t\t\tfd.cfac_fechacreacion AS Fecha_Factura,\n\t\t\t\tea.fecha AS tiempos,\n\t\t\t\tea.estado,\n\t\t\t\tfd.cfac_fechacreacion AS Fecha_Creacion,\n\t\t\t\tfd.rst_id AS Cod_Restaurante\t\t\t\n\t\t\t\tFROM pos_ecu_mp.Cabecera_Factura AS fd\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Periodo AS per ON fd.IDPeriodo = per.IDPeriodo and fd.CodigoCentroCosto = per.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Cliente AS cl ON fd.IDCliente = cl.IDCliente and cl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Cabecera_App ca ON fd.cfac_id = ca.cfac_id and ca.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Estado_Pedido_App AS ea ON ea.codigo_app = ca.codigo_app and ea.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\t--INNER JOIN pos_ecu_mp.Motorolo AS mo ON ca.IDMotorolo = mo.IDMotorolo and mo.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tleft JOIN pos_ecu_mp.Users_Pos AS us ON fd.IDUsersPos = us.IDUsersPos\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Status st ON fd.IDStatus = st.IDStatus AND fd.IDStatus = '5E039503-85CF-E511-80C6-000D3A3261F3'\n\t\t\t\t\tWHERE ea.estado IN ('ENTREGADO','EN CAMINO') AND cast(per.prd_fechaapertura as date) >= @FechaDesde AND cast(per.prd_fechaapertura as date) < @FechaHasta\n\t\t\t\t) dom\n\t\tPIVOT (MAX(Tiempos) FOR estado in ([ENTREGADO] ,[EN CAMINO]) ) AS pv) Final\n\t\tINNER JOIN pos_ecu_mp.Cabecera_Factura fac ON Final.Cod_factura = fac.cfac_id AND fac.CodigoCentroCosto = final.CodigoCentroCosto\n\t\tWHERE ASignada IS NOT NULL\n\n--ACTUALIZAR REGIONES\nUPDATE [dsa_ecu_sg].[Consolidado_DomicilioTiempos]\nSET [dsa_ecu_sg].[Consolidado_DomicilioTiempos].Region = dwh_dim.centrocosto.RegionOperacion\nFROM dwh_dim.centrocosto \nWHERE [dsa_ecu_sg].[Consolidado_DomicilioTiempos].cod_restaurante = dwh_dim.centrocosto.idcentrocostosg and dwh_dim.centrocosto.idcentrocostosg > 0 and dwh_dim.centrocosto.pais = 'ecu'\n\nexec dwh_dim.usp_CargaCabeceraDomicilio 'ECU', 'MANUAL'\nEXEC dwh_ecu_domi.usp_CargaFacSgProductividadDomicilio @FechaDesde ,@FechaHasta, 0, 'ECU', 'MANUAL'",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							}
						}
					}
				],
				"folder": {
					"name": "Carga_dwh_Triggers"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dsa_Conta_ConsolidadoTarjetas')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ConsolidadoAlia",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAlia]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAlia]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT FechaCarga,Codigo,Local,Voucher,Consumo,Neto,IVA,RetencionIVA,RetencionFuente,Comision,Otro,Otro1,Otro2,ValorNeto,ValorR,NombreArchivo,CodigoCentroCosto,CentroCosto,Cadena,Empresa,FechaPago FROM dsa_ecu_archivo.ConsolidadoAlia",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "Local",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Neto",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIVA",
											"type": "Double"
										},
										{
											"name": "RetencionFuente",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "Otro",
											"type": "Double"
										},
										{
											"name": "Otro1",
											"type": "Double"
										},
										{
											"name": "Otro2",
											"type": "Double"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "ValorR",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaPago",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAlia]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "Local",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Neto",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIVA",
											"type": "Double"
										},
										{
											"name": "RetencionFuente",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "Otro",
											"type": "Double"
										},
										{
											"name": "Otro1",
											"type": "Double"
										},
										{
											"name": "Otro2",
											"type": "Double"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "ValorR",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaPago",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAlia]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoAmerican",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT FechaCarga,FechaPago,Recap,Voucher,ValorNeto,TipoCredito,Cuota,FechaVoucher,STProceso,Codigo,NombreEstablecimiento,Marca,Tarjeta,Empresa,Consumo,Comision,IRF,IVA,RetencionIva,CodigoMatriz,CompRetencion,NombreArchivo,CodigoCentroCosto,CentroCosto,Cadena FROM dsa_ecu_archivo.ConsolidadoAmerican",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "Int64"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "TipoCredito",
											"type": "Double"
										},
										{
											"name": "Cuota",
											"type": "Double"
										},
										{
											"name": "FechaVoucher",
											"type": "String"
										},
										{
											"name": "STProceso",
											"type": "Double"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "NombreEstablecimiento",
											"type": "String"
										},
										{
											"name": "Marca",
											"type": "String"
										},
										{
											"name": "Tarjeta",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IRF",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIva",
											"type": "Double"
										},
										{
											"name": "CodigoMatriz",
											"type": "String"
										},
										{
											"name": "CompRetencion",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAmerican]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "Int64"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "TipoCredito",
											"type": "Double"
										},
										{
											"name": "Cuota",
											"type": "Double"
										},
										{
											"name": "FechaVoucher",
											"type": "String"
										},
										{
											"name": "STProceso",
											"type": "Double"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "NombreEstablecimiento",
											"type": "String"
										},
										{
											"name": "Marca",
											"type": "String"
										},
										{
											"name": "Tarjeta",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IRF",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIva",
											"type": "Double"
										},
										{
											"name": "CodigoMatriz",
											"type": "String"
										},
										{
											"name": "CompRetencion",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoBankard",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoBankard]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoBankard]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT FechaCarga,FechaPago,Fecha,Codigo,Local,Lote,Voucher,Consumo,Comision,IVA,Retencion,Neto,1 AS [1],2 AS [2],BancoBolivariano,Estado,NombreArchivo,CodigoCentroCosto,CentroCosto,Cadena,Empresa, FechaArchivo FROM dsa_ecu_archivo.ConsolidadoBankard",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "DateTime"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "Local",
											"type": "String"
										},
										{
											"name": "Lote",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "Retencion",
											"type": "Double"
										},
										{
											"name": "Neto",
											"type": "Double"
										},
										{
											"name": "1",
											"type": "Double"
										},
										{
											"name": "2",
											"type": "Double"
										},
										{
											"name": "BancoBolivariano",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoBankard]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "DateTime"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "Local",
											"type": "String"
										},
										{
											"name": "Lote",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "Retencion",
											"type": "Double"
										},
										{
											"name": "Neto",
											"type": "Double"
										},
										{
											"name": "1",
											"type": "Double"
										},
										{
											"name": "2",
											"type": "Double"
										},
										{
											"name": "BancoBolivariano",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoBankard]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoDiners",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoDiners]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoDiners]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT FechaCarga,NumeroFila,Estado,Voucher,EUPHXT,FechaPago,Codigo,EUN8NU,EUN9NU,Consumo,EUEJNR,EUAGN1,EUT8VL,EUT9VL,EUUAVL,EURETE,EUOANU,EUUBVL,EUUCVL,EUCAU1,EUTVAL,EUNREC,EUNLOT,EUFKXT,EUJ6NB,EUQLNU,EUQMNU,EUWYXT,EUWZXT,EUW5XT,EUTHXT,EUNOVR,EUNPVR,EUAA20,NombreArchivo,CodigoCentroCosto,CentroCosto,Cadena,Empresa, FechaArchivo FROM dsa_ecu_archivo.ConsolidadoDiners",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "NumeroFila",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "EUPHXT",
											"type": "String"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "EUN8NU",
											"type": "String"
										},
										{
											"name": "EUN9NU",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "EUEJNR",
											"type": "String"
										},
										{
											"name": "EUAGN1",
											"type": "Double"
										},
										{
											"name": "EUT8VL",
											"type": "Double"
										},
										{
											"name": "EUT9VL",
											"type": "Double"
										},
										{
											"name": "EUUAVL",
											"type": "Double"
										},
										{
											"name": "EURETE",
											"type": "Double"
										},
										{
											"name": "EUOANU",
											"type": "Double"
										},
										{
											"name": "EUUBVL",
											"type": "Double"
										},
										{
											"name": "EUUCVL",
											"type": "Double"
										},
										{
											"name": "EUCAU1",
											"type": "Double"
										},
										{
											"name": "EUTVAL",
											"type": "Double"
										},
										{
											"name": "EUNREC",
											"type": "String"
										},
										{
											"name": "EUNLOT",
											"type": "String"
										},
										{
											"name": "EUFKXT",
											"type": "String"
										},
										{
											"name": "EUJ6NB",
											"type": "String"
										},
										{
											"name": "EUQLNU",
											"type": "String"
										},
										{
											"name": "EUQMNU",
											"type": "String"
										},
										{
											"name": "EUWYXT",
											"type": "String"
										},
										{
											"name": "EUWZXT",
											"type": "String"
										},
										{
											"name": "EUW5XT",
											"type": "String"
										},
										{
											"name": "EUTHXT",
											"type": "String"
										},
										{
											"name": "EUNOVR",
											"type": "Double"
										},
										{
											"name": "EUNPVR",
											"type": "Double"
										},
										{
											"name": "EUAA20",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoDiners]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "NumeroFila",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "EUPHXT",
											"type": "String"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "EUN8NU",
											"type": "String"
										},
										{
											"name": "EUN9NU",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "EUEJNR",
											"type": "String"
										},
										{
											"name": "EUAGN1",
											"type": "Double"
										},
										{
											"name": "EUT8VL",
											"type": "Double"
										},
										{
											"name": "EUT9VL",
											"type": "Double"
										},
										{
											"name": "EUUAVL",
											"type": "Double"
										},
										{
											"name": "EURETE",
											"type": "Double"
										},
										{
											"name": "EUOANU",
											"type": "Double"
										},
										{
											"name": "EUUBVL",
											"type": "Double"
										},
										{
											"name": "EUUCVL",
											"type": "Double"
										},
										{
											"name": "EUCAU1",
											"type": "Double"
										},
										{
											"name": "EUTVAL",
											"type": "Double"
										},
										{
											"name": "EUNREC",
											"type": "String"
										},
										{
											"name": "EUNLOT",
											"type": "String"
										},
										{
											"name": "EUFKXT",
											"type": "String"
										},
										{
											"name": "EUJ6NB",
											"type": "String"
										},
										{
											"name": "EUQLNU",
											"type": "String"
										},
										{
											"name": "EUQMNU",
											"type": "String"
										},
										{
											"name": "EUWYXT",
											"type": "String"
										},
										{
											"name": "EUWZXT",
											"type": "String"
										},
										{
											"name": "EUW5XT",
											"type": "String"
										},
										{
											"name": "EUTHXT",
											"type": "String"
										},
										{
											"name": "EUNOVR",
											"type": "Double"
										},
										{
											"name": "EUNPVR",
											"type": "Double"
										},
										{
											"name": "EUAA20",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoDiners]"
								}
							}
						]
					},
					{
						"name": "CodigoTarjeta",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[CentroCostoFinanciadora]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[CentroCostoFinanciadora]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT  FechaCarga,[codigo]\n      ,[estado]\n      ,[descripcion]\n      ,[codcentrocosto]\n      ,[codentfin]\n      ,[fideicomiso]\n  FROM [dsa_ecu_archivo].[CentroCostoFinanciadora]",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "codigo",
											"type": "Int32"
										},
										{
											"name": "estado",
											"type": "String"
										},
										{
											"name": "descripcion",
											"type": "String"
										},
										{
											"name": "codcentrocosto",
											"type": "String"
										},
										{
											"name": "codentfin",
											"type": "String"
										},
										{
											"name": "fideicomiso",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[CentroCostoFinanciadora]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "codigo",
											"type": "Int32"
										},
										{
											"name": "estado",
											"type": "String"
										},
										{
											"name": "descripcion",
											"type": "String"
										},
										{
											"name": "codcentrocosto",
											"type": "String"
										},
										{
											"name": "codentfin",
											"type": "String"
										},
										{
											"name": "fideicomiso",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[CentroCostoFinanciadora]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoAliatxt",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAlia]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAlia]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT [FechaCarga]\n      ,[TipoTransaccion]\n      ,[Lote]\n      ,[NumeroReferencia]\n      ,[ValorAcreditado]\n      ,[num1]\n      ,[num2]\n      ,[FechaVenta]\n      ,[CodigoEstablecimiento]\n      ,[Maskara]\n      ,[BaseImponible]\n      ,[RetencionIva]\n      ,[Neto]\n      ,[Iva]\n      ,[Comision]\n      ,[NombreArchivo]\n      ,[CodigoCentroCosto]\n      ,[CentroCosto]\n      ,[Cadena]\n      ,[Empresa]\n      ,[FechaArchivo]\n  FROM [dw_dwh_suscripcion].[dsa_ecu_archivo].[ConsolidadoAliatxt]",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "TipoTransaccion",
											"type": "String"
										},
										{
											"name": "Lote",
											"type": "String"
										},
										{
											"name": "NumeroReferencia",
											"type": "String"
										},
										{
											"name": "ValorAcreditado",
											"type": "String"
										},
										{
											"name": "num1",
											"type": "String"
										},
										{
											"name": "num2",
											"type": "String"
										},
										{
											"name": "FechaVenta",
											"type": "String"
										},
										{
											"name": "CodigoEstablecimiento",
											"type": "String"
										},
										{
											"name": "Maskara",
											"type": "String"
										},
										{
											"name": "BaseImponible",
											"type": "String"
										},
										{
											"name": "RetencionIva",
											"type": "String"
										},
										{
											"name": "Neto",
											"type": "String"
										},
										{
											"name": "Iva",
											"type": "String"
										},
										{
											"name": "Comision",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAliatxt]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "TipoTransaccion",
											"type": "String"
										},
										{
											"name": "Lote",
											"type": "String"
										},
										{
											"name": "NumeroReferencia",
											"type": "String"
										},
										{
											"name": "ValorAcreditado",
											"type": "String"
										},
										{
											"name": "num1",
											"type": "String"
										},
										{
											"name": "num2",
											"type": "String"
										},
										{
											"name": "FechaVenta",
											"type": "String"
										},
										{
											"name": "CodigoEstablecimiento",
											"type": "String"
										},
										{
											"name": "Maskara",
											"type": "String"
										},
										{
											"name": "BaseImponible",
											"type": "String"
										},
										{
											"name": "RetencionIva",
											"type": "String"
										},
										{
											"name": "Neto",
											"type": "String"
										},
										{
											"name": "Iva",
											"type": "String"
										},
										{
											"name": "Comision",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAliatxt]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoAmericanNuevo",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT  [FechaCarga]\n      ,[FechaPago]\n      ,[Recap]\n      ,[Voucher]\n      ,[ValorNeto]\n      ,[TipoCredito]\n      ,[Cuota]\n      ,[FechaVoucher]\n      ,[STProceso]\n      ,[Codigo]\n      ,[NombreEstablecimiento]\n      ,[Marca]\n      ,[Tarjeta]\n      ,[Empresa]\n      ,[Consumo]\n      ,[Comision]\n      ,[IRF]\n      ,[IVA]\n      ,[RetencionIva]\n      ,[CodigoMatriz]\n      ,[CompRetencion]\n      ,[NombreArchivo]\n      ,[CodigoCentroCosto]\n      ,[CentroCosto]\n      ,[Cadena]\n      ,[Valor1]\n      ,[FechaArchivo]\n  FROM [dsa_ecu_archivo].[ConsolidadoAmericanNuevo]",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "Int64"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "TipoCredito",
											"type": "Double"
										},
										{
											"name": "Cuota",
											"type": "Double"
										},
										{
											"name": "FechaVoucher",
											"type": "String"
										},
										{
											"name": "STProceso",
											"type": "Double"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "NombreEstablecimiento",
											"type": "String"
										},
										{
											"name": "Marca",
											"type": "String"
										},
										{
											"name": "Tarjeta",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IRF",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIva",
											"type": "Double"
										},
										{
											"name": "CodigoMatriz",
											"type": "String"
										},
										{
											"name": "CompRetencion",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Valor1",
											"type": "Double"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAmericanNuevo]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "Int64"
										},
										{
											"name": "Voucher",
											"type": "Int32"
										},
										{
											"name": "ValorNeto",
											"type": "Double"
										},
										{
											"name": "TipoCredito",
											"type": "Double"
										},
										{
											"name": "Cuota",
											"type": "Double"
										},
										{
											"name": "FechaVoucher",
											"type": "String"
										},
										{
											"name": "STProceso",
											"type": "Double"
										},
										{
											"name": "Codigo",
											"type": "String"
										},
										{
											"name": "NombreEstablecimiento",
											"type": "String"
										},
										{
											"name": "Marca",
											"type": "String"
										},
										{
											"name": "Tarjeta",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "IRF",
											"type": "Double"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "RetencionIva",
											"type": "Double"
										},
										{
											"name": "CodigoMatriz",
											"type": "String"
										},
										{
											"name": "CompRetencion",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Valor1",
											"type": "Double"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoAmericanNuevo]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoBolivariano",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT [FechaCarga]\n      ,[FechaPago]\n      ,[Fecha]\n      ,[Codigo]\n      ,[Local]\n      ,[Lote]\n      ,[Voucher]\n      ,[Consumo]\n      ,[Comision]\n      ,[IVA]\n      ,[Retencion]\n      ,[Neto]\n      ,[1]\n      ,[2]\n      ,[BancoBolivariano]\n      ,[Estado]\n      ,[NombreArchivo]\n      ,[CodigoCentroCosto]\n      ,[CentroCosto]\n      ,[Cadena]\n      ,[Empresa]\n      ,[FechaArchivo]\n  FROM [dw_dwh_suscripcion].[dsa_ecu_archivo].[ConsolidadoBolivariano]",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Fecha",
											"type": "String"
										},
										{
											"name": "Codigo",
											"type": "Int64"
										},
										{
											"name": "Local",
											"type": "Int32"
										},
										{
											"name": "Lote",
											"type": "Double"
										},
										{
											"name": "Voucher",
											"type": "Double"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "String"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "Retencion",
											"type": "String"
										},
										{
											"name": "Neto",
											"type": "String"
										},
										{
											"name": "1",
											"type": "String"
										},
										{
											"name": "2",
											"type": "String"
										},
										{
											"name": "BancoBolivariano",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoBolivariano]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "FechaPago",
											"type": "String"
										},
										{
											"name": "Fecha",
											"type": "String"
										},
										{
											"name": "Codigo",
											"type": "Int64"
										},
										{
											"name": "Local",
											"type": "Int32"
										},
										{
											"name": "Lote",
											"type": "Double"
										},
										{
											"name": "Voucher",
											"type": "Double"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "String"
										},
										{
											"name": "IVA",
											"type": "Double"
										},
										{
											"name": "Retencion",
											"type": "String"
										},
										{
											"name": "Neto",
											"type": "String"
										},
										{
											"name": "1",
											"type": "String"
										},
										{
											"name": "2",
											"type": "String"
										},
										{
											"name": "BancoBolivariano",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoBolivariano]"
								}
							}
						]
					},
					{
						"name": "ConsolidadoKushki",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_ecu_archivo].[ConsolidadoAmerican]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT  [FechaCarga]\n      ,[Error]\n      ,[No]\n      ,[FechaMovimiento]\n      ,[FechaPagare]\n      ,[Comercio]\n      ,[NombreLocal]\n      ,[Recap]\n      ,[Voucher]\n      ,[Consumo]\n      ,[Iva]\n      ,[OtrosValores]\n      ,[Propina]\n      ,[Total]\n      ,[Comision]\n      ,[RetIva]\n      ,[RetFte]\n      ,[ValorLiquidado]\n      ,[Operador]\n      ,[BinCaptura]\n      ,[BinTarjeta]\n      ,[Autorizacion]\n      ,[EmpresaAdquiriente]\n      ,[EmpresaEmisor]\n      ,[FechaCompensacion]\n      ,[FechaPagoComercio]\n      ,[TipoIntercambio]\n      ,[TipoConsumo]\n      ,[CuotasPac]\n      ,[CuotasPago]\n      ,[TipoCaptura]\n      ,[Estado]\n      ,[FechaProceso]\n      ,[TipoMovimiento]\n      ,[Ruc]\n      ,[EmpresaKushki]\n      ,[IndInternet]\n      ,[TipoBancoEmisor]\n      ,[MontoConIva]\n      ,[MontoSinIva]\n      ,[ValorIvaComision]\n      ,[TipoIvaComision]\n      ,[IvaComisionBanco]\n      ,[IvaComisionQtBco]\n      ,[PorcComison]\n      ,[ValorBaseComison]\n      ,[NombreArchivo]\n      ,[CodigoCentroCosto]\n      ,[CentroCosto]\n      ,[Cadena]\n      ,[Empresa]\n      ,[FechaArchivo]\n  FROM [dw_dwh_suscripcion].[dsa_ecu_archivo].[ConsolidadoKushki]",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_Sharepoint",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Error",
											"type": "String"
										},
										{
											"name": "No",
											"type": "Int32"
										},
										{
											"name": "FechaMovimiento",
											"type": "Date"
										},
										{
											"name": "FechaPagare",
											"type": "Date"
										},
										{
											"name": "Comercio",
											"type": "String"
										},
										{
											"name": "NombreLocal",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "OtrosValores",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Total",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "RetIva",
											"type": "Double"
										},
										{
											"name": "RetFte",
											"type": "Double"
										},
										{
											"name": "ValorLiquidado",
											"type": "Double"
										},
										{
											"name": "Operador",
											"type": "String"
										},
										{
											"name": "BinCaptura",
											"type": "String"
										},
										{
											"name": "BinTarjeta",
											"type": "String"
										},
										{
											"name": "Autorizacion",
											"type": "String"
										},
										{
											"name": "EmpresaAdquiriente",
											"type": "String"
										},
										{
											"name": "EmpresaEmisor",
											"type": "String"
										},
										{
											"name": "FechaCompensacion",
											"type": "date"
										},
										{
											"name": "FechaPagoComercio",
											"type": "date"
										},
										{
											"name": "FechaPagoComercio",
											"type": "date"
										},
										{
											"name": "TipoIntercambio",
											"type": "String"
										},
										{
											"name": "TipoConsumo",
											"type": "String"
										},
										{
											"name": "CuotasPac",
											"type": "Int32"
										},
										{
											"name": "CuotasPago",
											"type": "Int32"
										},
										{
											"name": "TipoCaptura",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "FechaProceso",
											"type": "date"
										},
										{
											"name": "TipoMovimiento",
											"type": "Int32"
										},
										{
											"name": "Ruc",
											"type": "String"
										},
										{
											"name": "EmpresaKushki",
											"type": "Int32"
										},
										{
											"name": "IndInternet",
											"type": "String"
										},
										{
											"name": "TipoBancoEmisor",
											"type": "String"
										},
										{
											"name": "MontoConIva",
											"type": "Double"
										},
										{
											"name": "MontoSinIva",
											"type": "Double"
										},
										{
											"name": "ValorIvaComision",
											"type": "Double"
										},
										{
											"name": "TipoIvaComision",
											"type": "String"
										},
										{
											"name": "IvaComisionBanco",
											"type": "Double"
										},
										{
											"name": "IvaComisionQtBco",
											"type": "Double"
										},
										{
											"name": "PorcComison",
											"type": "Double"
										},
										{
											"name": "ValorBaseComison",
											"type": "Double"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoKushki]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatos",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Error",
											"type": "String"
										},
										{
											"name": "No",
											"type": "Int32"
										},
										{
											"name": "FechaMovimiento",
											"type": "Date"
										},
										{
											"name": "FechaPagare",
											"type": "Date"
										},
										{
											"name": "Comercio",
											"type": "String"
										},
										{
											"name": "NombreLocal",
											"type": "String"
										},
										{
											"name": "Recap",
											"type": "String"
										},
										{
											"name": "Voucher",
											"type": "String"
										},
										{
											"name": "Consumo",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "OtrosValores",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Total",
											"type": "Double"
										},
										{
											"name": "Comision",
											"type": "Double"
										},
										{
											"name": "RetIva",
											"type": "Double"
										},
										{
											"name": "RetFte",
											"type": "Double"
										},
										{
											"name": "ValorLiquidado",
											"type": "Double"
										},
										{
											"name": "Operador",
											"type": "String"
										},
										{
											"name": "BinCaptura",
											"type": "String"
										},
										{
											"name": "BinTarjeta",
											"type": "String"
										},
										{
											"name": "Autorizacion",
											"type": "String"
										},
										{
											"name": "EmpresaAdquiriente",
											"type": "String"
										},
										{
											"name": "EmpresaEmisor",
											"type": "String"
										},
										{
											"name": "FechaCompensacion",
											"type": "date"
										},
										{
											"name": "FechaPagoComercio",
											"type": "date"
										},
										{
											"name": "FechaPagoComercio",
											"type": "date"
										},
										{
											"name": "TipoIntercambio",
											"type": "String"
										},
										{
											"name": "TipoConsumo",
											"type": "String"
										},
										{
											"name": "CuotasPac",
											"type": "Int32"
										},
										{
											"name": "CuotasPago",
											"type": "Int32"
										},
										{
											"name": "TipoCaptura",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "String"
										},
										{
											"name": "FechaProceso",
											"type": "date"
										},
										{
											"name": "TipoMovimiento",
											"type": "Int32"
										},
										{
											"name": "Ruc",
											"type": "String"
										},
										{
											"name": "EmpresaKushki",
											"type": "Int32"
										},
										{
											"name": "IndInternet",
											"type": "String"
										},
										{
											"name": "TipoBancoEmisor",
											"type": "String"
										},
										{
											"name": "MontoConIva",
											"type": "Double"
										},
										{
											"name": "MontoSinIva",
											"type": "Double"
										},
										{
											"name": "ValorIvaComision",
											"type": "Double"
										},
										{
											"name": "TipoIvaComision",
											"type": "String"
										},
										{
											"name": "IvaComisionBanco",
											"type": "Double"
										},
										{
											"name": "IvaComisionQtBco",
											"type": "Double"
										},
										{
											"name": "PorcComison",
											"type": "Double"
										},
										{
											"name": "ValorBaseComison",
											"type": "Double"
										},
										{
											"name": "NombreArchivo",
											"type": "String"
										},
										{
											"name": "CodigoCentroCosto",
											"type": "String"
										},
										{
											"name": "CentroCosto",
											"type": "String"
										},
										{
											"name": "Cadena",
											"type": "String"
										},
										{
											"name": "Empresa",
											"type": "String"
										},
										{
											"name": "FechaArchivo",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_ecu_archivo].[ConsolidadoKushki]"
								}
							}
						]
					}
				],
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZSHAREPBDD\\BD_NEGOCIO"
					},
					"BaseDatos": {
						"type": "string",
						"defaultValue": "dw_dwh_suscripcion"
					}
				},
				"folder": {
					"name": "dsa_Intranet"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}