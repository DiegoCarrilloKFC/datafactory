{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "df-bi-dwh"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/pl_Carga_Chl_Domicilio')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Carga CHL DOMI",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_DomicilioChl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "CHL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Inicializar Carga Domicilio CHL",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Carga CHL DOMI",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA DOMICILIO CHILE',DATEADD(HH,-5,GETDATE()),DATEADD(HH,-5,GETDATE()),1\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					}
				],
				"folder": {
					"name": "Carga_dwh_Triggers"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pl_dwh_Operaciones_DomicilioChl')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_Carga_Multipais')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Carga DSA SG Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA AX Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_DynamicsAx_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA MP Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Maxpoint_Ecu_Drive",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_dwh_suscripcion"
							}
						}
					},
					{
						"name": "Carga Dimension",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga DSA SG Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Col",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Chl",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA AX Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA MP Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA Conta Reg",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA Sip Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG Arg",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA DOM Chl",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SAP",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA DOM Col",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Dimensiones",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ALL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Operacion Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Venta Acumulada Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Plantas Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Venta Acumulada Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Planta_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Operacion Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Venta Acumulada Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "CHL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga DSA SG INV Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_CAR_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Chl",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Auditoria_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "CHL",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Inicializar Etapas",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Inicializar Info Suscripcion",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "EXEC [dsa_int_lst].[usp_CargaTabla]\nEXEC [dsa_int_lst].[usp_CargaDependenciaTabla]\nEXEC [admin_btc].[usp_CargaTabla]\nEXEC [admin_btc].[usp_CargaDependenciaTabla]\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'ECU'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'ECU'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'ECU'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'COL'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'COL'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'COL'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'CHL'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'CHL'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'CHL'\n\nEXEC admin_btc.usp_CargaInicialLogEjecucionEtapa 'ARG'\nEXEC admin_btc.usp_CargaInicialLogEjecucionTabla 'ARG'\nEXEC [admin_btc].[usp_CargaInicialLogEjecucionCubo] 'ARG'\n\n--Control de Cargas\nTRUNCATE TABLE admin_btc.CargaDataFactory\n\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA VENTA-CAR-PLANTA',DATEADD(HH,-5,GETDATE()),NULL,0\n\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA ARGENTINA',DATEADD(HH,-5,GETDATE()),NULL,0\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga DSA DOM Col",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Domicilio_Col",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Recarga Permisologia",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Info Suscripcion",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_App_Seguridad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_admin_Bi"
							}
						}
					},
					{
						"name": "Carga Info Sus Dim",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Dimension",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Info_Suscripcion_Proceso",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Proceso": "DIMENSION",
								"SP": "admin_btc.usp_CargaInfoSuscripcion_Dimension"
							}
						}
					},
					{
						"name": "Carga DSA Conta Reg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_App_ContabilidadRegional",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "SharePoint_ListaExterna"
							}
						}
					},
					{
						"name": "Finalizar Carga Venta",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Carga Cinnabon Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Operaciones POS Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Plantas Venta Embutser",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Tiempos Domicilio",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga CAR Chl",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA VENTA-CAR-PLANTA'\n\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA ARGENTINA'\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga Plantas Venta Embutser",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Plantas Ecu",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga Operacion Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Planta_Ecu_Venta_Embutser",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga DSA Sip Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Sip_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SG INV Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Ecu_Transaccional_Inventario",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga Cinnabon Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Cinnabon",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Inicializar Info Suscripcion",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_CargaInfoSuscripcion_Inicializa]"
						},
						"linkedServiceName": {
							"referenceName": "linked_sharepoint",
							"type": "LinkedServiceReference",
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_dwh_suscripcion"
							}
						}
					},
					{
						"name": "Carga Operaciones POS Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga CAR Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_POS_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga DSA SG Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_SistemaGerente_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga Operacion Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Venta Acumulada Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ARG",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga CAR Arg",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Operacion Arg",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Auditoria_Arg",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ARG",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Inicializar Carga Uyc",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Finalizar Carga Venta",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nINSERT INTO admin_btc.CargaDataFactory\nSELECT CAST(DATEADD(HH,-5,GETDATE()) AS DATE),'CARGA USO CONSUMO ECU',DATEADD(HH,-5,GETDATE()),NULL,0\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga Operacion UyC Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Carga Uyc",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_UyC_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Verificar Proceso Cubos Venta",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Carga Operacion UyC Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Verificar Carga Venta').output.firstRow.Resultado, 'OK')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Verificar Carga Venta",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Espera",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "IF EXISTS(SELECT * FROM admin_btc.CargaDataFactory WHERE Proceso = 'PROCESO SSAS VENTA-CAR-PLANTA' AND Estado = 1)\n\tSELECT 'OK' AS Resultado\nELSE\n\tSELECT 'REINTENTAR' AS Resultado",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "ds_dwh_general",
											"type": "DatasetReference"
										}
									}
								},
								{
									"name": "Espera",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 180
									}
								}
							],
							"timeout": "00.12:00:00"
						}
					},
					{
						"name": "Carga DSA DOM Chl",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Domicilio_Chl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Carga DSA SAP",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Inicializar Etapas",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dsa_Sap_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Tiempos Domicilio",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Carga Operacion Ecu",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [dsa_ecu_sg].[Consolidado_DomicilioTiempos]\n\n--RANGO DE FECHAS\nDECLARE @FechaDesde DATETIME = CAST(GETDATE()-30 AS DATE)\nDECLARE @FechaHasta DATETIME = CAST(GETDATE() AS DATE)\n\n--INSERTAR DATOS\nINSERT INTO [dsa_ecu_sg].[Consolidado_DomicilioTiempos] \nSELECT\n\t'20210322',\n\tCAST(SUBSTRING(Final.cod_factura,6,14)AS INT)AS Factura,\n\tFinal.cod_telefono,\n\tCliente,\n\tCod_ZipCode,\n\tMotorizado,\n\tDespachador,\n\ttotal,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS Hora,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignada,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS Llegada,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS HoraC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignadaC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS LlegadaC,\n\tfinal.fecha,\n\tfinal.Cod_Restaurante,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS CreacionC,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS Creacion,\n\tYEAR(Fecha_Factura) AS Anio,\n\t'' AS Region,\n\tCASE WHEN fac.Cod_AppMovil is null THEN isnull(fac.Medio,'Llamada') ELSE isnull(fac.Medio,'App') END  AS Tipo_Pedido,\n\tCASE WHEN Dispositivo is null THEN '-' ELSE Dispositivo END Dispositivo\nFROM\n\t(\n\t\tSELECT\n\t\t\tCodigoCentroCosto,\n\t\t\tCod_Restaurante,\n\t\t\tfecha,\n\t\t\tcod_factura,\n\t\t\tcod_telefono,\n\t\t\tCliente,\n\t\t\tCod_ZipCode,\n\t\t\tMotorizado,\n\t\t\tDespachador,\n\t\t\ttotal,\n\t\t\tFecha_Factura,\n\t\t\tFecha_Creacion,\n\t\t\t[3] AS ASignada,\n\t\t\t[1] AS Llegada\n\t\tFROM\n\t\t\t( \n\t\t\tSELECT\n\t\t\t\tper.CodigoCentroCosto,\n\t\t\t\tper.fecha,\n\t\t\t\tfd.cod_factura,\n\t\t\t\tfd.cod_telefono,\n\t\t\t\t(cl.Nombres+SPACE(1)+cl.Apellidos) AS Cliente,\n\t\t\t\tInm.Cod_ZipCode,\n\t\t\t\t(mo.Nombres+SPACE(1)+mo.Apellidos) AS Motorizado,\n\t\t\t\tUPPER(us.Usuario) AS Despachador,\n\t\t\t\tfd.TotalBruto AS total,\n\t\t\t\tfd.fecha AS Fecha_Factura,\n\t\t\t\tfm.fecha AS tiempos,\n\t\t\t\tfm.cod_estado,\n\t\t\t\tfd.Fecha_Creacion,\n\t\t\t\tper.Cod_Restaurante,\n\t\t\t\tCASE\n\t\t\t\t\tWHEN medio IS NULL\t\t\t\t\tAND dispositivo = 'Android'\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'Android'\t\t\t\tAND dispositivo = 'App'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo IS NULL\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo = 'Android'\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo = 'iOS'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo = 'App'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo = 'Web'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'App'\t\t\t\t\tAND dispositivo = 'Llamada'\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'iOS'\t\t\t\t\tAND dispositivo = 'App'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo IS NULL\t\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo = 'Llamada'\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo = 'Android'\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo = 'Ios'\t\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo = 'Uber'\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Llamada'\t\t\t\tAND dispositivo = 'Web'\t\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN medio = 'Tictuk'\t\t\t\tAND dispositivo = 'TICTUK'\t\tTHEN '20ECU'\n\t\t\t\t\tWHEN medio = 'Call Center Regional'\tAND dispositivo = 'Operadores'\tTHEN '26ECU'\n\t\t\t\t\tWHEN medio = 'mobile'\t\t\t\tAND dispositivo = 'Web'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'Web'\t\t\t\t\tAND dispositivo = 'mobile'\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'Web'\t\t\t\t\tAND dispositivo IS NULL\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio = 'Web'\t\t\t\t\tAND dispositivo = 'web'\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN medio IS NULL\tAND dispositivo IS NULL\tAND Cod_AppMovil IS NULL THEN '7ECU'\n\t\t\t\tELSE null\n\t\t\t\tEND IDMedio\t\t\t\t\n\t\t\t\tFROM pos_ecu_domi.factura_domicilio AS fd\n\t\t\t\t\tINNER JOIN pos_ecu_domi.periodo AS per ON fd.cod_periodo = per.cod_periodo and fd.CodigoCentroCosto = per.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Cliente_Domicilio AS cl ON fd.Cod_Cliente_Domicilio = cl.Cod_Cliente_Domicilio and cl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Telefonos AS tl ON fd.Cod_Telefono = tl.Cod_Telefono and tl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Inmueble AS Inm ON tl.Cod_inmueble = Inm.Cod_inmueble and inm.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Factura_Motorolo AS fm ON fd.cod_factura = fm.cod_factura and fm.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Motorolos AS mo ON fm.Cod_Motorolo = mo.Cod_Motorolo and mo.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tleft JOIN pos_ecu_domi.Users AS us ON fd.cod_usuario = us.cod_usuario\n\t\t\t\t\tINNER JOIN pos_ecu_domi.Restaurante AS res ON per.Cod_Restaurante  = res.Cod_Restaurante\n\t\t\t\t\tWHERE fd.Estado = 4 AND fm.Cod_estado IN (1, 3) AND per.Fecha >= @FechaDesde and per.Fecha <= @FechaHasta \n\t\t\t\t) dom\n\t\tPIVOT (MAX(Tiempos) FOR cod_estado in ([1] ,[3]) ) AS pv\n\t\tWHERE IDMedio IN ('6ECU','7ECU','8ECU','20ECU','26ECU','27ECU')) Final\n\t\tINNER JOIN pos_ecu_domi.Factura_Domicilio fac ON Final.Cod_factura = fac.Cod_Factura AND fac.CodigoCentroCosto = final.CodigoCentroCosto\n\t\tWHERE ASignada IS NOT NULL\nUNION ALL\nSELECT \n\t'20210316',\n\tCAST(SUBSTRING(Final.cod_factura,6,14)AS INT)AS Factura,\n\t0 as cod_telefono,\n\tSUBSTRING(Cliente,1,150),\n\tSUBSTRING(Cod_ZipCode,1,15),\n\tSUBSTRING(Motorizado,1,150),\n\tSUBSTRING(Despachador,1,20),\n\ttotal,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS Hora,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignada,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS Llegada,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),1,2))END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Fecha_Factura,108),4,2)) AS HoraC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),ASignada,108),4,2)) AS ASignadaC,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2))='00' THEN '24' ELSE (SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Llegada,108),4,2)) AS LlegadaC,\n\tfinal.fecha,\n\tfinal.Cod_Restaurante,\n\t(CASE WHEN(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END*60)+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS CreacionC,\n\tCASE WHEN (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2))= '00'THEN '24'ELSE (SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),1,2)) END+(SUBSTRING(CONVERT(VARCHAR(11),Final.Fecha_Creacion,108),4,2)) AS Creacion,\n\tYEAR(Fecha_Factura) AS Anio,\n\t'' AS Region,\n\t'' AS Tipo_Pedido, --CASE WHEN fac.Cod_AppMovil is null THEN isnull(fac.Medio,'Llamada') ELSE isnull(fac.Medio,'App') END  AS Tipo_Pedido,\n\t'' AS Dispositivo --CASE WHEN Dispositivo is null THEN '-' ELSE Dispositivo END Dispositivo\nFROM\n\t(\n\t\tSELECT\n\t\t\tCodigoCentroCosto,\n\t\t\tCod_Restaurante,\n\t\t\tfecha,\n\t\t\tcod_factura,\n\t\t\tcod_telefono,\n\t\t\tCliente,\n\t\t\tCod_ZipCode,\n\t\t\tMotorizado,\n\t\t\tDespachador,\n\t\t\ttotal,\n\t\t\tFecha_Factura,\n\t\t\tCASE WHEN ban=1 THEN Fecha_Factura ELSE [PENDIENTE] END AS Fecha_Creacion,\n\t\t\t[EN CAMINO] AS ASignada,\n\t\t\t[ENTREGADO] AS Llegada\n\t\tFROM\n\t\t\t( \n\t\t\tSELECT \n\t\t\t\tper.CodigoCentroCosto,\n\t\t\t\tper.prd_fechaapertura AS Fecha,\n\t\t\t\tfd.cfac_id AS cod_factura,\n\t\t\t\tcl.cli_telefono AS cod_telefono,\n\t\t\t\t(cl.cli_nombres+SPACE(1)+cl.cli_apellidos) AS Cliente,\n\t\t\t\tISNULL(ca.cod_ZipCode,'') AS Cod_ZipCode,\n\t\t\t\t'' AS Motorizado,--(mo.Nombres+SPACE(1)+mo.Apellidos) AS Motorizado,\n\t\t\t\tUPPER(us.usr_descripcion) AS Despachador,\n\t\t\t\tfd.cfac_total AS total,\n\t\t\t\tfd.cfac_fechacreacion AS Fecha_Factura,\n\t\t\t\tCASE WHEN fd.Cabecera_FacturaVarchar2='Llamada' THEN 1 ELSE 0 END AS ban,\n\t\t\t\tea.fecha AS tiempos,\n\t\t\t\tea.estado,\n\t\t\t\tfd.rst_id AS Cod_Restaurante,\n\t\t\t\tCASE\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='App'\t\t\t\t\t\tTHEN '6ECU'\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='Web'\t\t\t\t\t\tTHEN '8ECU'\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='Llamada'\t\t\t\t\tTHEN '7ECU'\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='TICTUK'\t\t\t\t\tTHEN '20ECU'\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='Call Center Regional'\t\tTHEN '26ECU'\n\t\t\t\t\tWHEN ISNULL(fd.Cabecera_FacturaVarchar2,'') ='Web-e'\t\t\t\t\tTHEN '27ECU'\n\t\t\t\tELSE null\n\t\t\t\tEND IDMedio\t\t\t\n\t\t\t\tFROM pos_ecu_mp.Cabecera_Factura AS fd\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Periodo AS per ON fd.IDPeriodo = per.IDPeriodo and fd.CodigoCentroCosto = per.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Cliente AS cl ON fd.IDCliente = cl.IDCliente and cl.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Cabecera_App ca ON fd.cfac_id = ca.cfac_id and ca.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Estado_Pedido_App AS ea ON ea.codigo_app = ca.codigo_app and ea.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\t--INNER JOIN pos_ecu_mp.Motorolo AS mo ON ca.IDMotorolo = mo.IDMotorolo and mo.CodigoCentroCosto = fd.CodigoCentroCosto\n\t\t\t\t\tleft JOIN pos_ecu_mp.Users_Pos AS us ON fd.IDUsersPos = us.IDUsersPos\n\t\t\t\t\tINNER JOIN pos_ecu_mp.Status st ON fd.IDStatus = st.IDStatus AND fd.IDStatus = '5E039503-85CF-E511-80C6-000D3A3261F3'\n\t\t\t\t\tWHERE ea.estado IN ('ENTREGADO','EN CAMINO','PENDIENTE') AND cast(per.prd_fechaapertura as date) >= @FechaDesde AND cast(per.prd_fechaapertura as date) < @FechaHasta\n\t\t\t\t) dom\n\t\tPIVOT (MAX(Tiempos) FOR estado in ([ENTREGADO] ,[EN CAMINO],[PENDIENTE]) ) AS pv\n\t\tWHERE IDMedio in ('6ECU','7ECU','8ECU','20ECU','26ECU','27ECU')) Final\n\t\tINNER JOIN pos_ecu_mp.Cabecera_Factura fac ON Final.Cod_factura = fac.cfac_id AND fac.CodigoCentroCosto = final.CodigoCentroCosto\n\t\tWHERE ASignada IS NOT NULL\n\n--ACTUALIZAR REGIONES\nUPDATE [dsa_ecu_sg].[Consolidado_DomicilioTiempos]\nSET [dsa_ecu_sg].[Consolidado_DomicilioTiempos].Region = dwh_dim.centrocosto.RegionOperacion\nFROM dwh_dim.centrocosto \nWHERE [dsa_ecu_sg].[Consolidado_DomicilioTiempos].cod_restaurante = dwh_dim.centrocosto.idcentrocostosg and dwh_dim.centrocosto.idcentrocostosg > 0 and dwh_dim.centrocosto.pais = 'ecu'\n\nexec dwh_dim.usp_CargaCabeceraDomicilio 'ECU', 'MANUAL'\nEXEC dwh_ecu_domi.usp_CargaFacSgProductividadDomicilio @FechaDesde ,@FechaHasta, 0, 'ECU', 'MANUAL'\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Carga Venta Acumulada Ecu",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Info Sus Dim",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Operaciones_Venta_Acum_Ecu",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": "0",
								"Pais": "ECU",
								"TipoCarga": "AUTOMATICA"
							}
						}
					},
					{
						"name": "Carga Continua",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Verificar Proceso Cubos Venta",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_Carga_Multipais_Ext",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					}
				],
				"folder": {
					"name": "Carga_dwh_Triggers"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pl_dwh_Operaciones_Chl')]",
				"[concat(variables('factoryId'), '/pipelines/pl_dwh_Operaciones_POS_Ecu')]",
				"[concat(variables('factoryId'), '/pipelines/pl_Carga_Multipais_Ext')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_Carga_Multipais_Ext')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Finalizar Carga UyC",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Verificar Proceso Cubos Col",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Control de Cargas\nUPDATE admin_btc.CargaDataFactory\nSET FechaHasta = DATEADD(HH,-5,GETDATE()), Estado = 1\nWHERE FechaPeriodo =  CAST(DATEADD(HH,-5,GETDATE()) AS DATE) AND Proceso = 'CARGA USO CONSUMO ECU'\n\nSELECT 'ok' AS Resultado",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference"
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Carga COL DOMI OPE CAR",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_Carga_COL_DOMI_OPE_CAR",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					},
					{
						"name": "Verificar Proceso Cubos Col",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Carga CHL DOMI",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Carga COL DOMI OPE CAR",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Verificar Carga Venta COL').output.firstRow.Resultado, 'OK')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Verificar Carga Venta COL",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Espera_copy1",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "IF EXISTS(SELECT * FROM admin_btc.CargaDataFactory WHERE Proceso = 'PROCESO SSAS VENTA COL' AND Estado = 1)\n\tSELECT 'OK' AS Resultado\nELSE\n\tSELECT 'REINTENTAR' AS Resultado",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "ds_dwh_general",
											"type": "DatasetReference"
										}
									}
								},
								{
									"name": "Espera_copy1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 180
									}
								}
							],
							"timeout": "00.12:00:00"
						}
					},
					{
						"name": "Carga CHL DOMI",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_Carga_Chl_Domicilio",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true
						}
					}
				],
				"folder": {
					"name": "Carga_dwh_Triggers"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pl_Carga_Chl_Domicilio')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dsa_Domicilio_Chl_Transaccional_Historico')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Detalle_Factura",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden,Descuento_con_Impuesto,Descuento FROM dbo.Detalle_Factura_resp det INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Detalle_Factura]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Factura_Anulacion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Anulacion]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Anulacion]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Factura_Anulacion]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Anulacion]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Anulacion]"
								}
							}
						]
					},
					{
						"name": "Factura_Domicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo, fac.Cod_Desasignacion,fac.CodPersonalDespacho,fac.Nombre,fac.RUC,fac.Direccion,fac.bringg,fac.Cod_Bringg,fac.TipoAsignacion,fac.Impresion,fac.Impresion_Comanda,fac.Impresion_Factura,fac.Solicita_Autorizacion FROM dbo.Factura_Domicilio_resp fac INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Factura_Domicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Domicilio_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Factura_FormasPago",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_FormasPago]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_FormasPago]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx,ffp.Cod_Desasignacion,0 IDTipoEnvio,0 Transaction_id FROM dbo.Factura_FormasPago_resp ffp INNER JOIN dbo.Factura_Domicilio_resp fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Factura_FormasPago]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Factura_FormasPago_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_FormasPago]"
								}
							}
						]
					},
					{
						"name": "Factura_Motorolo",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Motorolo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Motorolo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo_resp fmo INNER JOIN dbo.Factura_Domicilio_resp fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Factura_Motorolo]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Motorolo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Motorolo]"
								}
							}
						]
					},
					{
						"name": "Modificador_Detalle_Factura",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Modificador_Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura_resp mdf INNER JOIN dbo.Detalle_Factura_resp det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Modificador_Detalle_Factura]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Modificador_Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Detalle_Factura_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Detalle_Factura",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden,Descuento_con_Impuesto,Descuento FROM dbo.Detalle_Factura_resp det INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Detalle_Factura_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Detalle_Factura_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden,Descuento_con_Impuesto,Descuento FROM dbo.Detalle_Factura_resp det INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										},
										{
											"name": "Descuento_con_Impuesto",
											"type": "Double"
										},
										{
											"name": "Descuento",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Factura_Anulacion_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Anulacion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Anulacion]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Anulacion]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}') AND CAST(Fecha_anulacion AS DATE) >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Anulacion]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Anulacion]"
								}
							}
						]
					},
					{
						"name": "Factura_Anulacion_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Anulacion_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Anulacion]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Anulacion]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}') AND CAST(Fecha_anulacion AS DATE) >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Anulacion]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Anulacion]"
								}
							}
						]
					},
					{
						"name": "Factura_Domicilio_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Domicilio_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo, fac.Cod_Desasignacion,fac.CodPersonalDespacho,fac.Nombre,fac.RUC,fac.Direccion,fac.bringg,fac.Cod_Bringg,fac.TipoAsignacion,fac.Impresion,fac.Impresion_Comanda,fac.Impresion_Factura,fac.Solicita_Autorizacion FROM dbo.Factura_Domicilio_resp fac INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Domicilio_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Factura_FormasPago_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_FormasPago_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_FormasPago]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_FormasPago]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx,ffp.Cod_Desasignacion,0 IDTipoEnvio,0 Transaction_id FROM dbo.Factura_FormasPago_resp ffp INNER JOIN dbo.Factura_Domicilio_resp fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Factura_FormasPago_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_FormasPago]"
								}
							}
						]
					},
					{
						"name": "Factura_Motorolo_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Motorolo_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Motorolo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Motorolo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo_resp fmo INNER JOIN dbo.Factura_Domicilio_resp fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Motorolo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Motorolo]"
								}
							}
						]
					},
					{
						"name": "Modificador_Detalle_Factura_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Modificador_Detalle_Factura_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Modificador_Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura_resp mdf INNER JOIN dbo.Detalle_Factura_resp det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Modificador_Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Factura_Domicilio_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Domicilio",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo, fac.Cod_Desasignacion,fac.CodPersonalDespacho,fac.Nombre,fac.RUC,fac.Direccion,fac.bringg,fac.Cod_Bringg,fac.TipoAsignacion,fac.Impresion,fac.Impresion_Comanda,fac.Impresion_Factura,fac.Solicita_Autorizacion FROM dbo.Factura_Domicilio_resp fac INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Domicilio_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int64"
										},
										{
											"name": "CodPersonalDespacho",
											"type": "Int64"
										},
										{
											"name": "Nombre",
											"type": "String"
										},
										{
											"name": "RUC",
											"type": "String"
										},
										{
											"name": "Direccion",
											"type": "String"
										},
										{
											"name": "bringg",
											"type": "Int32"
										},
										{
											"name": "Cod_Bringg",
											"type": "Int32"
										},
										{
											"name": "TipoAsignacion",
											"type": "String"
										},
										{
											"name": "Impresion",
											"type": "Int32"
										},
										{
											"name": "Impresion_Comanda",
											"type": "Int32"
										},
										{
											"name": "Impresion_Factura",
											"type": "Int32"
										},
										{
											"name": "Solicita_Autorizacion",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Factura_FormasPago_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_FormasPago",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_FormasPago]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_FormasPago]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx,ffp.Cod_Desasignacion,0 IDTipoEnvio,0 Transaction_id FROM dbo.Factura_FormasPago_resp ffp INNER JOIN dbo.Factura_Domicilio_resp fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Factura_FormasPago_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										},
										{
											"name": "Cod_Desasignacion",
											"type": "Int32"
										},
										{
											"name": "IDTipoEnvio",
											"type": "Int32"
										},
										{
											"name": "Transaction_id",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_FormasPago]"
								}
							}
						]
					},
					{
						"name": "Factura_Motorolo_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Factura_Motorolo",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Motorolo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Factura_Motorolo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo_resp fmo INNER JOIN dbo.Factura_Domicilio_resp fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Motorolo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Factura_Motorolo]"
								}
							}
						]
					},
					{
						"name": "Modificador_Detalle_Factura_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Modificador_Detalle_Factura",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Modificador_Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura_resp mdf INNER JOIN dbo.Detalle_Factura_resp det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio_resp fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo_resp per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}' AND per.Fecha >'20210330'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Modificador_Detalle_Factura_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Modificador_Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Periodo",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Periodo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Periodo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Periodo,Cod_Restaurante,Fecha,Estado FROM dbo.Periodo_resp",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_chl_domi].[Periodo]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Periodo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Periodo]"
								}
							}
						]
					},
					{
						"name": "Periodo_KFC_G1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Periodo",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Periodo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Periodo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Periodo,Cod_Restaurante,Fecha,Estado FROM dbo.Periodo_resp WHERE Fecha >'20210330'",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Periodo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G1",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Periodo]"
								}
							}
						]
					},
					{
						"name": "Periodo_KFC_G2",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Periodo_KFC_G1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Periodo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_chl_domi].[Periodo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Periodo,Cod_Restaurante,Fecha,Estado FROM dbo.Periodo_resp WHERE Fecha >'20210330'",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioChl",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Periodo_resp]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "SqlGerenteDomKFC_G2",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_chl_domi].[Periodo]"
								}
							}
						]
					}
				],
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "192.168.148.110"
					},
					"BaseDatosDomicilioGerente": {
						"type": "string",
						"defaultValue": "SqlGerenteDom"
					},
					"FechaDesde": {
						"type": "string"
					},
					"FechaHasta": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_DomicilioChl"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Dimensiones_3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Dimensiones",
				"activities": [
					{
						"name": "dim_CargaTipoDocumentoTarjeta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaTipoDocumentoTarjeta",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_CargaClaseTarjeta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaClaseTarjeta",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_CargaAdquirente",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaAdquirente",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_CargaDenominacionProyecto",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaDenominacionProyecto",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_CargaCentroCostoConstruciones",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaCentroCostoConstruciones",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_CargaCadenaConstruciones",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaCadenaConstruccion",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_PuntoExpedicion",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaPuntoExpedicion",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_ClientePos",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaClientePos",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "dim_Persona",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_dim",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaPersona",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "int",
						"defaultValue": 0
					},
					"Pais": {
						"type": "String",
						"defaultValue": "ECU"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_Dimensiones"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Operaciones_Chl')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Operaciones",
				"activities": [
					{
						"name": "ope_FacSgVentaDiaria",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaDiaria2018",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaAgrupacion",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaMix",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgMovimientoInventarioDiario",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaAgrupacion",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaAcumulada",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaDiaria",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaAcumulada",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaMix",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaMix",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgMovimientoInventarioDiario",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgArticuloBodega",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgMovimientoInventarioDiario",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "cubo_FacRegalia",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaDiaria",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgVentaAgrupacion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_cubo",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacRegalia",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaAgrupacionAcumulada",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaAgrupacion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaAgrupacionAcumulada",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgUsoConsumo",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgMovimientoInventarioDiario",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgUsoConsumo",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "cubo_FacRdd",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaAcumulada",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgPyG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_cubo",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacRdd",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgResumenOperacion",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaFormaPago",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgVentaAcumulada",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgVentaMix",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgUsoConsumo",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgResumenOperacion",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgCajaChica",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgCajaChica",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaHora",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaHora",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaFormaPago",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaFormaPago",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "cubo_FacVAR",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaAcumulada",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ope_FacSgPyG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_cubo",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacVAR",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgPyG",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgPyG",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaHoraAcumulada",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaHora",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgVentaHoraAcumulada",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgAuditoria",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgAuditoria",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgArticuloBodega",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacSgArticuloBodega",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Carga Info Sus Venta",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ope_FacSgAuditoria",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "ope_FacSgVentaAcumulada",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Info_Suscripcion_Proceso",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Proceso": "VENTA_CHL",
								"SP": "admin_btc.usp_CargaInfoSuscripcion_Venta_Chl"
							}
						}
					},
					{
						"name": "Carga Info Sus Costos",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ope_FacSgResumenOperacion",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Info_Suscripcion_Proceso",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Proceso": "COSTOS_CHL",
								"SP": "admin_btc.usp_CargaInfoSuscripcion_Costos_Chl"
							}
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "String",
						"defaultValue": "0"
					},
					"Pais": {
						"type": "String",
						"defaultValue": "CHL"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_OperacionesChl"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Operaciones_DomicilioChl')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Operaciones",
				"activities": [
					{
						"name": "domi_FacVenta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_domi",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacVenta",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "domi_FacVentaProducto",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "domi_FacVenta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_domi",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacVentaProducto",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "domi_FacVentaFormaPago",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "domi_FacVentaProducto",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_chl_domi",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacVentaFormaPago",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "String",
						"defaultValue": "0"
					},
					"Pais": {
						"type": "String",
						"defaultValue": "CHL"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_OperacionesChl"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Operaciones_POS_Ecu')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Operaciones POS",
				"activities": [
					{
						"name": "ope_FacPOSVentaHoraAcumulada",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_ecu_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacPosVentaHoraAcumulada",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacAuditoriaVenta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacPOSVentaHoraAcumulada",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_ecu_cubo",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacAuditoriaVenta",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacPosVentaAcumulada_DarkKitchen",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_ecu_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacPosVentaAcumulada_DarkKitchen",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Carga Info Sus POS",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ope_FacPosVentaAcumulada_DarkKitchen",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Info_Suscripcion_Proceso",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Proceso": "POS_ECU",
								"SP": "admin_btc.usp_CargaInfoSuscripcion_POS_Ecu"
							}
						}
					},
					{
						"name": "ope_FacPosVenta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_EjecutaSP]",
							"storedProcedureParameters": {
								"Esquema": {
									"value": "dwh_ecu_ope",
									"type": "String"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"Procedimiento": {
									"value": "usp_CargaFacPosVenta",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "String",
						"defaultValue": "0"
					},
					"Pais": {
						"type": "String",
						"defaultValue": "ECU"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_OperacionesEcu"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Recarga Venta Colombia')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Recarga Venta Agregador POS",
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_Recarga_Venta_Colombia",
							"type": "PipelineReference"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Week",
						"interval": 1,
						"startTime": "2020-04-21T23:55:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								30
							],
							"hours": [
								15
							],
							"weekDays": [
								"Monday"
							]
						}
					}
				}
			},
			"dependsOn": []
		}
	]
}