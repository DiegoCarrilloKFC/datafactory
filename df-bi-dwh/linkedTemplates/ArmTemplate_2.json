{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "df-bi-dwh"
		},
		"linked_sg_esp_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'linked_sg_esp'"
		},
		"linked_sharepoint_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'linked_sharepoint'"
		},
		"linked_sip_ecu_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'linked_sip_ecu'"
		},
		"linked_domicilio_col_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'linked_domicilio_col'"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/linked_sg_esp')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Conexión dinámica Sistema Gerente España",
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "192.168.146.61"
					},
					"BaseDatos": {
						"type": "string",
						"defaultValue": "SQLGerente_19"
					}
				},
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('linked_sg_esp_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IR-SistemaGerenteEsp",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/linked_sharepoint')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Conexión dinámica al ambiente de Sharepoint (Intranet)",
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZSHAREPBDD\\BD_NEGOCIO"
					},
					"BaseDatos": {
						"type": "string",
						"defaultValue": "dw_admin_Bi"
					}
				},
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('linked_sharepoint_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IR-BI-Sharepoint",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/linked_sip_ecu')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Conexión dinámica SIP - Presupuestos Ecuador",
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZCONTADB"
					},
					"BaseDatos": {
						"type": "string",
						"defaultValue": "Presupuestos"
					}
				},
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('linked_sip_ecu_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IR-ContabilidadEcu",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/linked_domicilio_col')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Sistema Gerente Domicilio Colombia",
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZGERENTECOL"
					},
					"BaseDatos": {
						"type": "string",
						"defaultValue": "Domicilio"
					}
				},
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('linked_domicilio_col_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IR-DomicilioCol",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_admin_Escalar_DWH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Ejecuta proceso de escalado del DWH\nSe debe setear el parametro DWU.",
				"activities": [
					{
						"name": "Escalar DWH",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "--Escalar Data Warehouse\nALTER DATABASE dwh\nMODIFY (SERVICE_OBJECTIVE = '@{pipeline().parameters.DWU}');\n\nSELECT 'ok' AS Resultado",
									"type": "Expression"
								}
							},
							"dataset": {
								"referenceName": "ds_dwh_master",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Verificar Estatus",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Escalar DWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "--Verificar estatus de escalado cada 5 segudnos\nWHILE \n(\n    SELECT TOP 1 state_desc\n    FROM sys.dm_operation_status\n    WHERE \n        1=1\n        AND resource_type_desc = 'Database'\n        AND major_resource_id = 'dwh'\n        AND operation = 'ALTER DATABASE'\n    ORDER BY\n        start_time DESC\n) = 'IN_PROGRESS'\nBEGIN\n    RAISERROR('El escalado de la base de datos está en progreso',0,0) WITH NOWAIT;\n    WAITFOR DELAY '00:00:05';\nEND\nWAITFOR DELAY '00:00:30';\nSelect 'Complete' AS Resultado;"
							},
							"dataset": {
								"referenceName": "ds_dwh_master",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"parameters": {
					"DWU": {
						"type": "string",
						"defaultValue": "DW100c"
					}
				},
				"folder": {
					"name": "Admin_dwh"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_admin_Reescalar_DWH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Verificar Proceso Cubos",
						"type": "Until",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Verificar Carga').output.firstRow.Resultado, 'REESCALAR')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Verificar Carga",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Espera",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "IF EXISTS(SELECT * FROM dwh.admin_btc.CargaDataFactory WHERE Proceso = 'PROCESO_CUBOS_MULTIPAIS' AND Estado = 1)\n\tSELECT 'REESCALAR' AS Resultado\nELSE\n\tSELECT 'REINTENTAR' AS Resultado"
										},
										"dataset": {
											"referenceName": "ds_dwh_general",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Espera",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 300
									}
								}
							],
							"timeout": "00.12:00:00"
						}
					},
					{
						"name": "Escalar DWH",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Verificar Proceso Cubos",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "--Escalar Data Warehouse\nALTER DATABASE dwh\nMODIFY (SERVICE_OBJECTIVE = '@{pipeline().parameters.DWU}');\n\nSELECT 'ok' AS Resultado",
									"type": "Expression"
								}
							},
							"dataset": {
								"referenceName": "ds_dwh_master",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"parameters": {
					"DWU": {
						"type": "string",
						"defaultValue": "DW100c"
					}
				},
				"folder": {
					"name": "Admin_dwh"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dsa_Domicilio_Col_Catalogo')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Area",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Area]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Area]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Area,Cod_Restaurante,Descripcion,Estado FROM dbo.Area"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Area]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Area",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Area]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Area",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Area]"
								}
							}
						]
					},
					{
						"name": "Calle",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Calle]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Calle]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Calle,Descripcion,Cod_Ciudad,Estado FROM dbo.Calle"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Calle]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Ciudad",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Calle]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Ciudad",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Calle]"
								}
							}
						]
					},
					{
						"name": "Calles_Back",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Calles_Back]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Calles_Back]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Calle_Back,Descripcion,Cod_Restaurante,Estado FROM dbo.Calles_Back"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Calles_Back]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle_Back",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Calles_Back]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle_Back",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Calles_Back]"
								}
							}
						]
					},
					{
						"name": "Calle_Restaurante",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Calle_Restaurante]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Calle_Restaurante]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Calle,Cod_Area,Estado FROM dbo.Calle_Restaurante"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Calle_Restaurante]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle",
											"type": "Int32"
										},
										{
											"name": "Cod_Area",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Calle_Restaurante]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Calle",
											"type": "Int32"
										},
										{
											"name": "Cod_Area",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Calle_Restaurante]"
								}
							}
						]
					},
					{
						"name": "Cliente_Domicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Cliente_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Cliente_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Cliente_Domicilio,Ruc_Cedula,Nombres,Apellidos,Observaciones,Email,Fecha,Ext,Estado,Cod_Tipo_Documento FROM dbo.Cliente_Domicilio"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Cliente_Domicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										},
										{
											"name": "Nombres",
											"type": "String"
										},
										{
											"name": "Apellidos",
											"type": "String"
										},
										{
											"name": "Observaciones",
											"type": "String"
										},
										{
											"name": "Email",
											"type": "String"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Ext",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Documento",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Cliente_Domicilio]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										},
										{
											"name": "Nombres",
											"type": "String"
										},
										{
											"name": "Apellidos",
											"type": "String"
										},
										{
											"name": "Observaciones",
											"type": "String"
										},
										{
											"name": "Email",
											"type": "String"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Ext",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Documento",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Cliente_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Compania",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Compania]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Compania]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Compania,Descripcion,Estado FROM dbo.Compania"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Compania]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Compania",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Compania]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Compania",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Compania]"
								}
							}
						]
					},
					{
						"name": "Estados_Domicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Estados_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Estados_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Estado,Factura,Asignacion FROM dbo.Estados_Domicilio"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Estados_Domicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Factura",
											"type": "String"
										},
										{
											"name": "Asignacion",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Estados_Domicilio]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Factura",
											"type": "String"
										},
										{
											"name": "Asignacion",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Estados_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Inmueble",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Inmueble]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Inmueble]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Inmueble,Cod_Tipo_Inmueble,Descripcion,Cod_Calle1,Cod_Calle2,Cod_ZipCode,Num_Direccion,Estado,Cod_Calle_Back1,Cod_Calle_Back2 FROM dbo.Inmueble"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Inmueble]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Inmueble",
											"type": "String"
										},
										{
											"name": "Cod_Tipo_Inmueble",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Calle1",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle2",
											"type": "Int32"
										},
										{
											"name": "Cod_ZipCode",
											"type": "String"
										},
										{
											"name": "Num_Direccion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle_Back1",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle_Back2",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Inmueble]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Inmueble",
											"type": "String"
										},
										{
											"name": "Cod_Tipo_Inmueble",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Cod_Calle1",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle2",
											"type": "Int32"
										},
										{
											"name": "Cod_ZipCode",
											"type": "String"
										},
										{
											"name": "Num_Direccion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle_Back1",
											"type": "Int32"
										},
										{
											"name": "Cod_Calle_Back2",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Inmueble]"
								}
							}
						]
					},
					{
						"name": "Modificador",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Modificador]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Modificador]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Modificador,Cod_Tipo_Modificador,Descripcion,Estado FROM dbo.Modificador"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Modificador]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Modificador]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Modificador]"
								}
							}
						]
					},
					{
						"name": "Motivo_Anulacion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Motivo_Anulacion]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Motivo_Anulacion]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Motivo,Descripcion,Estado FROM dbo.Motivo_Anulacion"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Motivo_Anulacion]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Motivo_Anulacion]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Motivo_Anulacion]"
								}
							}
						]
					},
					{
						"name": "Motorolos",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Motorolos]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Motorolos]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Motorolo,Cod_Compania,Cod_Restaurante,Cedula,Nombres,Apellidos,Cod_Tarjeta,Cod_Nomina,Estado,Telefono FROM dbo.Motorolos"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Motorolos]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Compania",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cedula",
											"type": "String"
										},
										{
											"name": "Nombres",
											"type": "String"
										},
										{
											"name": "Apellidos",
											"type": "String"
										},
										{
											"name": "Cod_Tarjeta",
											"type": "String"
										},
										{
											"name": "Cod_Nomina",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Telefono",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Motorolos]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Compania",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cedula",
											"type": "String"
										},
										{
											"name": "Nombres",
											"type": "String"
										},
										{
											"name": "Apellidos",
											"type": "String"
										},
										{
											"name": "Cod_Tarjeta",
											"type": "String"
										},
										{
											"name": "Cod_Nomina",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Telefono",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Motorolos]"
								}
							}
						]
					},
					{
						"name": "Periodo",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Periodo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Periodo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Periodo,Cod_Restaurante,Fecha,Estado FROM dbo.Periodo"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Periodo]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Periodo]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Periodo]"
								}
							}
						]
					},
					{
						"name": "Restaurante_CorrespondenciaDomicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Restaurante_CorrespondenciaDomicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Restaurante_CorrespondenciaDomicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Restaurante,Cod_Restaurante_Domicity FROM dbo.Restaurante_Correspondencia"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Restaurante_CorrespondenciaDomicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante_Domicity",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Restaurante_Correspondencia]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilio",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante_Domicity",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Restaurante_CorrespondenciaDomicilio]"
								}
							}
						]
					},
					{
						"name": "Restaurante_CorrespondenciaDomicilioWeb",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Restaurante_CorrespondenciaDomicilioWeb]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Restaurante_CorrespondenciaDomicilioWeb]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Restaurante,Cod_Restaurante_Domicity,Descripcion FROM dbo.Restaurante_Correspondencia"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Restaurante_CorrespondenciaDomicilioWeb]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante_Domicity",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Restaurante_Correspondencia]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioWeb",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante_Domicity",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Restaurante_CorrespondenciaDomicilioWeb]"
								}
							}
						]
					},
					{
						"name": "Telefonos",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Telefonos]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Telefonos]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Telefono,Cod_Inmueble,Tipo,Estado,Cod_Ciudad FROM dbo.Telefonos"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Telefonos]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Cod_Inmueble",
											"type": "String"
										},
										{
											"name": "Tipo",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Ciudad",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Telefonos]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Cod_Inmueble",
											"type": "String"
										},
										{
											"name": "Tipo",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Ciudad",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Telefonos]"
								}
							}
						]
					},
					{
						"name": "Telefono_Cliente",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Telefono_Cliente]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Telefono_Cliente]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Cliente_Domicilio,Cod_Telefono FROM dbo.Telefono_Cliente"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Telefono_Cliente]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										}
									],
									"cw_tableName": "[[dbo].[Telefono_Cliente]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Telefono_Cliente]"
								}
							}
						]
					},
					{
						"name": "Tipo_Accion_Domi",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Tipo_Accion_Domi]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Tipo_Accion_Domi]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Accion_Domi,Descripcion,Inicial,Estado FROM dbo.Tipo_Accion_Domi"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Tipo_Accion_Domi]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Accion_Domi",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Inicial",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Tipo_Accion_Domi]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Accion_Domi",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Inicial",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Tipo_Accion_Domi]"
								}
							}
						]
					},
					{
						"name": "Tipo_Inmueble",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Tipo_Inmueble]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Tipo_Inmueble]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Tipo_Inmueble,Descripcion,Detalle,Estado FROM dbo.Tipo_Inmueble"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Tipo_Inmueble]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Inmueble",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Detalle",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Tipo_Inmueble]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Inmueble",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Detalle",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Tipo_Inmueble]"
								}
							}
						]
					},
					{
						"name": "Tipo_Modificador",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Tipo_Modificador]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Tipo_Modificador]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Tipo_Modificador,Descripcion,Estado FROM dbo.Tipo_Modificador"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Tipo_Modificador]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Tipo_Modificador]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Descripcion",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Tipo_Modificador]"
								}
							}
						]
					},
					{
						"name": "Tipo_Modificador_Plu",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Tipo_Modificador_Plu]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Tipo_Modificador_Plu]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT GETDATE() AS FechaCarga,Cod_Tipo_Modificador_Plu,Cod_Tipo_Modificador,Cod_Plu,Estado FROM dbo.Tipo_Modificador_Plu"
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Tipo_Modificador_Plu]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Modificador_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Tipo_Modificador_Plu]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Tipo_Modificador_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Modificador",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Estado",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Tipo_Modificador_Plu]"
								}
							}
						]
					}
				],
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZGERENTECOL"
					},
					"BaseDatosDomicilio": {
						"type": "string",
						"defaultValue": "Domicilio"
					},
					"BaseDatosDomicilioWeb": {
						"type": "string",
						"defaultValue": "DomicilioWeb"
					},
					"BaseDatosDomicilioGerente": {
						"type": "string",
						"defaultValue": "SqlGerenteDom"
					}
				},
				"folder": {
					"name": "dsa_DomicilioCol"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dsa_Domicilio_Col_Transaccional')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cabecera_FacturaDomicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Cabecera_FacturaDomicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Cabecera_FacturaDomicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Restaurante,Estado_Transferencia,Fecha,Comentario_Factura,Estado,Cod_Telefono,Ruc_Cedula FROM dbo.Cabecera_Factura WHERE CAST(Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Cabecera_FacturaDomicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario_Factura",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Cabecera_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilio",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "Int32"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario_Factura",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Cabecera_FacturaDomicilio]"
								}
							}
						]
					},
					{
						"name": "Cabecera_FacturaDomicilioWeb",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Cabecera_FacturaDomicilioWeb]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Cabecera_FacturaDomicilioWeb]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Restaurante,Estado_Transferencia,Fecha,Comentario_Factura,Estado,Cod_Telefono,Ruc_Cedula FROM dbo.Cabecera_Factura WHERE CAST(Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' and DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Cabecera_FacturaDomicilioWeb]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "Int64"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario_Factura",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										}
									],
									"cw_tableName": "[[dbo].[Cabecera_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioWeb",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "Int64"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario_Factura",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Ruc_Cedula",
											"type": "String"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Cabecera_FacturaDomicilioWeb]"
								}
							}
						]
					},
					{
						"name": "Detalle_FacturaDomicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_FacturaDomicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Detalle_FacturaDomicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cantidad,det.Precio,det.Iva FROM dbo.Detalle_Factura det INNER JOIN dbo.Cabecera_Factura cab ON det.Cod_Factura=cab.Cod_Factura WHERE CAST(cab.Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Detalle_FacturaDomicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "Cod_Detalle_Factura",
											"type": "Guid"
										},
										{
											"name": "Cod_Factura",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Int32"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilio",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "Cod_Detalle_Factura",
											"type": "Guid"
										},
										{
											"name": "Cod_Factura",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Int32"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Detalle_FacturaDomicilio]"
								}
							}
						]
					},
					{
						"name": "Detalle_FacturaDomicilioWeb",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_FacturaDomicilioWeb]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Detalle_FacturaDomicilioWeb]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cantidad,det.Precio,det.Iva FROM dbo.Detalle_Factura det INNER JOIN dbo.Cabecera_Factura cab ON det.Cod_Factura=cab.Cod_Factura WHERE CAST(cab.Fecha AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Detalle_FacturaDomicilioWeb]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "Cod_Detalle_Factura",
											"type": "Guid"
										},
										{
											"name": "Cod_Factura",
											"type": "Int64"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Int32"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioWeb",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "Cod_Detalle_Factura",
											"type": "Guid"
										},
										{
											"name": "Cod_Factura",
											"type": "Int64"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Int32"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Detalle_FacturaDomicilioWeb]"
								}
							}
						]
					},
					{
						"name": "Detalle_Factura",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,det.Cod_Detalle_Factura,det.Cod_Factura,det.Cod_Plu,det.Cod_Plu_Promocion,det.Cantidad,det.Precio,det.Iva,det.Costo,det.Orden FROM dbo.Detalle_Factura det INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Detalle_Factura]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Detalle_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Plu",
											"type": "Int32"
										},
										{
											"name": "Cod_Plu_Promocion",
											"type": "Int32"
										},
										{
											"name": "Cantidad",
											"type": "Double"
										},
										{
											"name": "Precio",
											"type": "Double"
										},
										{
											"name": "Iva",
											"type": "Double"
										},
										{
											"name": "Costo",
											"type": "Double"
										},
										{
											"name": "Orden",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Detalle_Factura]"
								}
							}
						]
					},
					{
						"name": "Factura_Anulacion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Anulacion]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Factura_Anulacion]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,Cod_Factura,Cod_Motivo,Cod_Administrador,Cod_Motorolo,Observacion,Fecha_anulacion FROM dbo.Factura_Anulacion WHERE CAST(Fecha_anulacion AS DATE) BETWEEN '@{pipeline().parameters.FechaDesde}' AND DATEADD(DAY,1,'@{pipeline().parameters.FechaHasta}')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Anulacion]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Anulacion]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Motivo",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Observacion",
											"type": "String"
										},
										{
											"name": "Fecha_anulacion",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Factura_Anulacion]"
								}
							}
						]
					},
					{
						"name": "Factura_Domicilio",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Domicilio]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Factura_Domicilio]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fac.Cod_Factura,fac.Cod_Restaurante,fac.Cod_Cliente_Domicilio,fac.Cod_Periodo,fac.Cod_Usuario,fac.Cod_Administrador,fac.Estado_Transferencia,fac.Fecha,fac.Comentario,fac.Estado,fac.Consumidor_Final,fac.Cod_Telefono,fac.Transferencia,fac.Fecha_Creacion,fac.DescuentoIVA,fac.DescuentoNoIVA,fac.Direccion_Alterna,fac.Porcentaje,fac.Cod_Usuario_Descto,fac.Propina,fac.Serie_Dian,fac.Cod_Nota_Credito,fac.Tipo_Facturacion,fac.Cod_Tipo_Comprobante,fac.Clave_Acceso,fac.Numero_Factura,fac.Autorizado,fac.Datos_Adicionales,fac.FechaOperacion,fac.numeroAutorizacion,fac.ControlPendientes,fac.Compensacion,fac.Cod_AppMovil,fac.guiaTracking,fac.TotalBruto,fac.Subtotal,fac.IvaTotal,fac.SubCero,fac.SubImpuesto,fac.Medio,fac.Dispositivo,per.Fecha AS FechaPeriodo FROM dbo.Factura_Domicilio fac INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Domicilio]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Domicilio]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Restaurante",
											"type": "Int32"
										},
										{
											"name": "Cod_Cliente_Domicilio",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Usuario",
											"type": "Int32"
										},
										{
											"name": "Cod_Administrador",
											"type": "Int32"
										},
										{
											"name": "Estado_Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										},
										{
											"name": "Comentario",
											"type": "String"
										},
										{
											"name": "Estado",
											"type": "Int32"
										},
										{
											"name": "Consumidor_Final",
											"type": "Int32"
										},
										{
											"name": "Cod_Telefono",
											"type": "Int64"
										},
										{
											"name": "Transferencia",
											"type": "Int32"
										},
										{
											"name": "Fecha_Creacion",
											"type": "DateTime"
										},
										{
											"name": "DescuentoIVA",
											"type": "Double"
										},
										{
											"name": "DescuentoNoIVA",
											"type": "Double"
										},
										{
											"name": "Direccion_Alterna",
											"type": "String"
										},
										{
											"name": "Porcentaje",
											"type": "Double"
										},
										{
											"name": "Cod_Usuario_Descto",
											"type": "Int32"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "Serie_Dian",
											"type": "Int32"
										},
										{
											"name": "Cod_Nota_Credito",
											"type": "String"
										},
										{
											"name": "Tipo_Facturacion",
											"type": "Int32"
										},
										{
											"name": "Cod_Tipo_Comprobante",
											"type": "Int32"
										},
										{
											"name": "Clave_Acceso",
											"type": "String"
										},
										{
											"name": "Numero_Factura",
											"type": "String"
										},
										{
											"name": "Autorizado",
											"type": "Int32"
										},
										{
											"name": "Datos_Adicionales",
											"type": "String"
										},
										{
											"name": "FechaOperacion",
											"type": "DateTime"
										},
										{
											"name": "numeroAutorizacion",
											"type": "String"
										},
										{
											"name": "ControlPendientes",
											"type": "String"
										},
										{
											"name": "Compensacion",
											"type": "Double"
										},
										{
											"name": "Cod_AppMovil",
											"type": "String"
										},
										{
											"name": "guiaTracking",
											"type": "String"
										},
										{
											"name": "TotalBruto",
											"type": "Double"
										},
										{
											"name": "Subtotal",
											"type": "Double"
										},
										{
											"name": "IvaTotal",
											"type": "Double"
										},
										{
											"name": "SubCero",
											"type": "Double"
										},
										{
											"name": "SubImpuesto",
											"type": "Double"
										},
										{
											"name": "Medio",
											"type": "String"
										},
										{
											"name": "Dispositivo",
											"type": "String"
										},
										{
											"name": "FechaPeriodo",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Factura_Domicilio]"
								}
							}
						]
					},
					{
						"name": "Factura_FormasPago",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_FormasPago]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Factura_FormasPago]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,ffp.Cod_FFormasPago,ffp.Cod_Factura,ffp.Cod_FormaPago,ffp.Num_Tarjeta,ffp.Num_Seguridad,ffp.Fecha_Caducidad,ffp.Billete,ffp.NumeroCheque,ffp.Banco,ffp.Titular,ffp.Referencia_Billete,ffp.Valor_Billete,ffp.Total_Pagar,ffp.Propina,ffp.ClienteAx FROM dbo.Factura_FormasPago ffp INNER JOIN dbo.Factura_Domicilio fac ON ffp.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_FormasPago]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Factura_FormasPago]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_FFormasPago",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_FormaPago",
											"type": "Int32"
										},
										{
											"name": "Num_Tarjeta",
											"type": "String"
										},
										{
											"name": "Num_Seguridad",
											"type": "String"
										},
										{
											"name": "Fecha_Caducidad",
											"type": "String"
										},
										{
											"name": "Billete",
											"type": "Double"
										},
										{
											"name": "NumeroCheque",
											"type": "String"
										},
										{
											"name": "Banco",
											"type": "String"
										},
										{
											"name": "Titular",
											"type": "String"
										},
										{
											"name": "Referencia_Billete",
											"type": "String"
										},
										{
											"name": "Valor_Billete",
											"type": "Double"
										},
										{
											"name": "Total_Pagar",
											"type": "Double"
										},
										{
											"name": "Propina",
											"type": "Double"
										},
										{
											"name": "ClienteAx",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Factura_FormasPago]"
								}
							}
						]
					},
					{
						"name": "Factura_Motorolo",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Factura_Motorolo]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Factura_Motorolo]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,fmo.Cod_Motorolo,fmo.Cod_Factura,fmo.Cod_Periodo,fmo.Cod_Estado,fmo.Fecha FROM dbo.Factura_Motorolo fmo INNER JOIN dbo.Factura_Domicilio fac ON fmo.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Factura_Motorolo]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dbo].[Factura_Motorolo]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Motorolo",
											"type": "Int32"
										},
										{
											"name": "Cod_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Periodo",
											"type": "String"
										},
										{
											"name": "Cod_Estado",
											"type": "Int32"
										},
										{
											"name": "Fecha",
											"type": "DateTime"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Factura_Motorolo]"
								}
							}
						]
					},
					{
						"name": "Modificador_Detalle_Factura",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "[[dbo].[Modificador_Detalle_Factura]"
							},
							{
								"name": "Destination",
								"value": "[[dsa_col_domi].[Modificador_Detalle_Factura]"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT GETDATE() AS FechaCarga,mdf.Cod_Detalle_Factura,mdf.Cod_Modificador FROM dbo.Modificador_Detalle_Factura mdf INNER JOIN dbo.Detalle_Factura det on mdf.Cod_Detalle_Factura=det.Cod_Detalle_Factura INNER JOIN dbo.Factura_Domicilio fac ON det.Cod_Factura=fac.Cod_Factura INNER JOIN dbo.Periodo per ON fac.Cod_Periodo=per.Cod_Periodo WHERE per.Fecha BETWEEN '@{pipeline().parameters.FechaDesde}' AND '@{pipeline().parameters.FechaHasta}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"writeBatchSize": 10000,
								"preCopyScript": "TRUNCATE TABLE [dsa_col_domi].[Modificador_Detalle_Factura]",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "linked_storage",
									"type": "LinkedServiceReference"
								},
								"path": "contenedor"
							}
						},
						"inputs": [
							{
								"referenceName": "ds_DomicilioCol",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dbo].[Modificador_Detalle_Factura]",
									"cw_servidor": {
										"value": "@pipeline().parameters.Servidor",
										"type": "Expression"
									},
									"cw_baseDatos": {
										"value": "@pipeline().parameters.BaseDatosDomicilioGerente",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_dwh",
								"type": "DatasetReference",
								"parameters": {
									"cw_structure": [
										{
											"name": "FechaCarga",
											"type": "DateTime"
										},
										{
											"name": "Cod_Detalle_Factura",
											"type": "String"
										},
										{
											"name": "Cod_Modificador",
											"type": "Int32"
										}
									],
									"cw_tableName": "[[dsa_col_domi].[Modificador_Detalle_Factura]"
								}
							}
						]
					}
				],
				"parameters": {
					"Servidor": {
						"type": "string",
						"defaultValue": "SAZGERENTECOL"
					},
					"BaseDatosDomicilio": {
						"type": "string",
						"defaultValue": "Domicilio"
					},
					"BaseDatosDomicilioWeb": {
						"type": "string",
						"defaultValue": "DomicilioWeb"
					},
					"BaseDatosDomicilioGerente": {
						"type": "string",
						"defaultValue": "SqlGerenteDom"
					},
					"FechaDesde": {
						"type": "string"
					},
					"FechaHasta": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_DomicilioCol"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Contabilidad_Regional')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "arg_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_arg_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "ARG",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fecha Carga",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT\n\tFechaCarga=DATEADD(HH,-5,GETDATE()),\n\tFechaDesde=convert(smalldatetime,DATEADD(s,0,DATEADD(mm, DATEDIFF(m,0,DATEADD(HH,-5,GETDATE()))-1,0)),112),\n\tFechaHasta=convert(smalldatetime,EOMONTH(DATEADD(HH,-5,GETDATE()),-1),112)"
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "col_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_col_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "COL",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "chl_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_chl_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "CHL",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ecu_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_ecu_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "ECU",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usa_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_usa_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "USA",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "conta_FacContabilidadRegional",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "arg_FacContabilidadRegional",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "col_FacContabilidadRegional",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "chl_FacContabilidadRegional",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ecu_FacContabilidadRegional",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "usa_FacContabilidadRegional",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_conta].[usp_CargaFacContabilidadRegional]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHasta",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": "ECU",
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "string",
						"defaultValue": "0"
					},
					"TipoCarga": {
						"type": "string",
						"defaultValue": "AUTOMATICA"
					}
				},
				"folder": {
					"name": "dwh_CAREcu"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Dimensiones')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Dimensiones",
				"activities": [
					{
						"name": "Dimensiones_1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Dimensiones_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": {
									"value": "@pipeline().parameters.IDCadenaSistemaGerente",
									"type": "Expression"
								},
								"Pais": {
									"value": "@pipeline().parameters.Pais",
									"type": "Expression"
								},
								"TipoCarga": {
									"value": "@pipeline().parameters.TipoCarga",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Dimensiones_2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_dwh_Dimensiones_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"IDCadenaSistemaGerente": {
									"value": "@pipeline().parameters.IDCadenaSistemaGerente",
									"type": "Expression"
								},
								"Pais": {
									"value": "@pipeline().parameters.Pais",
									"type": "Expression"
								},
								"TipoCarga": {
									"value": "@pipeline().parameters.TipoCarga",
									"type": "Expression"
								}
							}
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "int",
						"defaultValue": 0
					},
					"Pais": {
						"type": "String",
						"defaultValue": "ECU"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_Dimensiones"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Info_Suscripcion_Proceso')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Carga Info Suscripcion",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Verificar Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Verificar Carga').output.firstRow.PermitirCarga, 'CARGAR')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Carga Info Suscripcion_",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 3,
										"retryIntervalInSeconds": 300,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": {
											"value": "@pipeline().parameters.SP",
											"type": "Expression"
										}
									},
									"linkedServiceName": {
										"referenceName": "linked_sharepoint",
										"type": "LinkedServiceReference",
										"parameters": {
											"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
											"BaseDatos": "dw_dwh_suscripcion"
										}
									}
								},
								{
									"name": "Finalizar Proceso",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Carga Info Suscripcion_",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderStoredProcedureName": "[[admin_btc].[usp_CargaInfoSuscripcion_Control]",
											"storedProcedureParameters": {
												"Paso": {
													"type": "String",
													"value": "ACTUALIZAR"
												},
												"Proceso": {
													"type": "String",
													"value": {
														"value": "@pipeline().parameters.Proceso",
														"type": "Expression"
													}
												}
											}
										},
										"dataset": {
											"referenceName": "ds_dwh_general",
											"type": "DatasetReference",
											"parameters": {}
										},
										"firstRowOnly": true
									}
								}
							]
						}
					},
					{
						"name": "Verificar Carga",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[admin_btc].[usp_CargaInfoSuscripcion_Control]",
								"storedProcedureParameters": {
									"Paso": {
										"type": "String",
										"value": "CARGAR"
									},
									"Proceso": {
										"type": "String",
										"value": {
											"value": "@pipeline().parameters.Proceso",
											"type": "Expression"
										}
									}
								}
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"parameters": {
					"Proceso": {
						"type": "string",
						"defaultValue": "DIMENSION"
					},
					"SP": {
						"type": "string",
						"defaultValue": "admin_btc.usp_CargaInfoSuscripcion_Dimension"
					}
				},
				"folder": {
					"name": "dwh_Intranet"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/linked_sharepoint')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Operaciones_Venta_Ecu')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Operaciones",
				"activities": [
					{
						"name": "ope_FacSgVentaDiaria",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_ecu_ope].[usp_CargaFacSgVentaDiaria2017]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHastaActual",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ope_FacSgVentaAcumulada",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaDiaria",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_ecu_ope].[usp_CargaFacSgVentaAcumulada]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHastaActual",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Carga Info Suscripcion Venta",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ope_FacSgVentaAcumulada",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "ope_FacSgAuditoria",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 3,
							"retryIntervalInSeconds": 300,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[admin_btc].[usp_CargaInfoSuscripcion_Recarga_Venta_Ecu]"
						},
						"linkedServiceName": {
							"referenceName": "linked_sharepoint",
							"type": "LinkedServiceReference",
							"parameters": {
								"Servidor": "SAZSHAREPBDD\\BD_NEGOCIO",
								"BaseDatos": "dw_dwh_suscripcion"
							}
						}
					},
					{
						"name": "Fecha Carga",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[admin_adm].[usp_CargaFecha]",
								"storedProcedureParameters": {
									"Dias": {
										"type": "Int32",
										"value": null
									},
									"FechaDesde": {
										"type": "DateTime",
										"value": null
									},
									"FechaFin": {
										"type": "DateTime",
										"value": null
									},
									"FechaHasta": {
										"type": "DateTime",
										"value": null
									}
								}
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ope_FacSgAuditoria",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Fecha Carga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_ecu_ope].[usp_CargaFacSgAuditoria]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaDesde",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@activity('Fecha Carga').output.firstRow.FechaHastaActual",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "String",
						"defaultValue": "0"
					},
					"Pais": {
						"type": "String",
						"defaultValue": "ECU"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_OperacionesEcu"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/linked_sharepoint')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_dwh_Planta_Ecu_Compras')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Carga Información Planta Ecuador",
				"activities": [
					{
						"name": "plt_FacPedidoCompra",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "FechaCarga",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dwh_ecu_plt].[usp_CargaFacPedidoCompra]",
							"storedProcedureParameters": {
								"FechaDesde": {
									"value": {
										"value": "@formatDateTime(activity('FechaCarga').output.firstRow.FechaDesde, 'yyyy-MM-dd')",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"FechaHasta": {
									"value": {
										"value": "@formatDateTime(activity('FechaCarga').output.firstRow.FechaHasta, 'yyyy-MM-dd')",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"IDCadenaSistemaGerente": {
									"value": {
										"value": "@pipeline().parameters.IDCadenaSistemaGerente",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Pais": {
									"value": {
										"value": "@pipeline().parameters.Pais",
										"type": "Expression"
									},
									"type": "String"
								},
								"TipoCarga": {
									"value": {
										"value": "@pipeline().parameters.TipoCarga",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "linked_dwh",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "FechaCarga",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[admin_adm].[usp_CargaFecha]",
								"storedProcedureParameters": {
									"Dias": {
										"type": "Int32",
										"value": "3"
									},
									"FechaDesde": {
										"type": "DateTime",
										"value": null
									},
									"FechaFin": {
										"type": "DateTime",
										"value": {
											"value": "@adddays(addhours(utcnow(),-5),1)",
											"type": "Expression"
										}
									},
									"FechaHasta": {
										"type": "DateTime",
										"value": null
									}
								}
							},
							"dataset": {
								"referenceName": "ds_dwh_general",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"parameters": {
					"IDCadenaSistemaGerente": {
						"type": "String",
						"defaultValue": "0"
					},
					"Pais": {
						"type": "String",
						"defaultValue": "ECU"
					},
					"TipoCarga": {
						"type": "String",
						"defaultValue": "MANUAL"
					}
				},
				"folder": {
					"name": "dwh_PlantaEcu"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_DynamicsAxEcu')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Dataset parametrizado DynamicsAx Ecuador",
				"linkedServiceName": {
					"referenceName": "linked_ax_ecu",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_DynamicsAx"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_MaxpointEcu')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Dataset parametrizado Maxpoint Ecuador",
				"linkedServiceName": {
					"referenceName": "linked_mp_ecu",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_Maxpoint"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_Sharepoint')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linked_sharepoint",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dwh_Sharepoint"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/linked_sharepoint')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_SipEcu')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linked_sip_ecu",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_Sip"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/linked_sip_ecu')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_SistemaGerenteArg')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linked_sg_arg",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_SistemaGerente"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_SistemaGerenteChl')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linked_sg_chl",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_SistemaGerente"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_SistemaGerenteCol')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linked_sg_col",
					"type": "LinkedServiceReference",
					"parameters": {
						"Servidor": {
							"value": "@dataset().cw_servidor",
							"type": "Expression"
						},
						"BaseDatos": {
							"value": "@dataset().cw_baseDatos",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"cw_structure": {
						"type": "Array"
					},
					"cw_tableName": {
						"type": "String"
					},
					"cw_servidor": {
						"type": "string"
					},
					"cw_baseDatos": {
						"type": "string"
					}
				},
				"folder": {
					"name": "dsa_SistemaGerente"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		}
	]
}